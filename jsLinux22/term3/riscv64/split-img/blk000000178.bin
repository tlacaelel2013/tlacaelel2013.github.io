R_32_RELA =          34;
enum R_M32R_24_RELA =          35;
enum R_M32R_10_PCREL_RELA =    36;
enum R_M32R_18_PCREL_RELA =    37;
enum R_M32R_26_PCREL_RELA =    38;
enum R_M32R_HI16_ULO_RELA =    39;
enum R_M32R_HI16_SLO_RELA =    40;
enum R_M32R_LO16_RELA =        41;
enum R_M32R_SDA16_RELA =       42;
enum R_M32R_RELA_GNU_VTINHERIT =       43;
enum R_M32R_RELA_GNU_VTENTRY = 44;
enum R_M32R_REL32 =            45;

enum R_M32R_GOT24 =            48;
enum R_M32R_26_PLTREL =        49;
enum R_M32R_COPY =             50;
enum R_M32R_GLOB_DAT =         51;
enum R_M32R_JMP_SLOT =         52;
enum R_M32R_RELATIVE =         53;
enum R_M32R_GOTOFF =           54;
enum R_M32R_GOTPC24 =          55;
enum R_M32R_GOT16_HI_ULO =     56;
enum R_M32R_GOT16_HI_SLO =     57;
enum R_M32R_GOT16_LO =         58;
enum R_M32R_GOTPC_HI_ULO =     59;
enum R_M32R_GOTPC_HI_SLO =     60;
enum R_M32R_GOTPC_LO =         61;
enum R_M32R_GOTOFF_HI_ULO =    62;
enum R_M32R_GOTOFF_HI_SLO =    63;
enum R_M32R_GOTOFF_LO =        64;
enum R_M32R_NUM =              256;
enum R_TILEPRO_NONE =          0;
enum R_TILEPRO_32 =            1;
enum R_TILEPRO_16 =            2;
enum R_TILEPRO_8 =             3;
enum R_TILEPRO_32_PCREL =      4;
enum R_TILEPRO_16_PCREL =      5;
enum R_TILEPRO_8_PCREL =       6;
enum R_TILEPRO_LO16 =          7;
enum R_TILEPRO_HI16 =          8;
enum R_TILEPRO_HA16 =          9;
enum R_TILEPRO_COPY =          10;
enum R_TILEPRO_GLOB_DAT =      11;
enum R_TILEPRO_JMP_SLOT =      12;
enum R_TILEPRO_RELATIVE =      13;
enum R_TILEPRO_BROFF_X1 =      14;
enum R_TILEPRO_JOFFLONG_X1 =   15;
enum R_TILEPRO_JOFFLONG_X1_PLT = 16;
enum R_TILEPRO_IMM8_X0 =       17;
enum R_TILEPRO_IMM8_Y0 =       18;
enum R_TILEPRO_IMM8_X1 =       19;
enum R_TILEPRO_IMM8_Y1 =       20;
enum R_TILEPRO_MT_IMM15_X1 =   21;
enum R_TILEPRO_MF_IMM15_X1 =   22;
enum R_TILEPRO_IMM16_X0 =      23;
enum R_TILEPRO_IMM16_X1 =      24;
enum R_TILEPRO_IMM16_X0_LO =   25;
enum R_TILEPRO_IMM16_X1_LO =   26;
enum R_TILEPRO_IMM16_X0_HI =   27;
enum R_TILEPRO_IMM16_X1_HI =   28;
enum R_TILEPRO_IMM16_X0_HA =   29;
enum R_TILEPRO_IMM16_X1_HA =   30;
enum R_TILEPRO_IMM16_X0_PCREL = 31;
enum R_TILEPRO_IMM16_X1_PCREL = 32;
enum R_TILEPRO_IMM16_X0_LO_PCREL = 33;
enum R_TILEPRO_IMM16_X1_LO_PCREL = 34;
enum R_TILEPRO_IMM16_X0_HI_PCREL = 35;
enum R_TILEPRO_IMM16_X1_HI_PCREL = 36;
enum R_TILEPRO_IMM16_X0_HA_PCREL = 37;
enum R_TILEPRO_IMM16_X1_HA_PCREL = 38;
enum R_TILEPRO_IMM16_X0_GOT =  39;
enum R_TILEPRO_IMM16_X1_GOT =  40;
enum R_TILEPRO_IMM16_X0_GOT_LO = 41;
enum R_TILEPRO_IMM16_X1_GOT_LO = 42;
enum R_TILEPRO_IMM16_X0_GOT_HI = 43;
enum R_TILEPRO_IMM16_X1_GOT_HI = 44;
enum R_TILEPRO_IMM16_X0_GOT_HA = 45;
enum R_TILEPRO_IMM16_X1_GOT_HA = 46;
enum R_TILEPRO_MMSTART_X0 =    47;
enum R_TILEPRO_MMEND_X0 =      48;
enum R_TILEPRO_MMSTART_X1 =    49;
enum R_TILEPRO_MMEND_X1 =      50;
enum R_TILEPRO_SHAMT_X0 =      51;
enum R_TILEPRO_SHAMT_X1 =      52;
enum R_TILEPRO_SHAMT_Y0 =      53;
enum R_TILEPRO_SHAMT_Y1 =      54;
enum R_TILEPRO_DEST_IMM8_X1 =  55;
enum R_TILEPRO_TLS_GD_CALL =   60;
enum R_TILEPRO_IMM8_X0_TLS_GD_ADD = 61;
enum R_TILEPRO_IMM8_X1_TLS_GD_ADD = 62;
enum R_TILEPRO_IMM8_Y0_TLS_GD_ADD = 63;
enum R_TILEPRO_IMM8_Y1_TLS_GD_ADD = 64;
enum R_TILEPRO_TLS_IE_LOAD =   65;
enum R_TILEPRO_IMM16_X0_TLS_GD = 66;
enum R_TILEPRO_IMM16_X1_TLS_GD = 67;
enum R_TILEPRO_IMM16_X0_TLS_GD_LO = 68;
enum R_TILEPRO_IMM16_X1_TLS_GD_LO = 69;
enum R_TILEPRO_IMM16_X0_TLS_GD_HI = 70;
enum R_TILEPRO_IMM16_X1_TLS_GD_HI = 71;
enum R_TILEPRO_IMM16_X0_TLS_GD_HA = 72;
enum R_TILEPRO_IMM16_X1_TLS_GD_HA = 73;
enum R_TILEPRO_IMM16_X0_TLS_IE = 74;
enum R_TILEPRO_IMM16_X1_TLS_IE = 75;
enum R_TILEPRO_IMM16_X0_TLS_IE_LO = 76;
enum R_TILEPRO_IMM16_X1_TLS_IE_LO = 77;
enum R_TILEPRO_IMM16_X0_TLS_IE_HI = 78;
enum R_TILEPRO_IMM16_X1_TLS_IE_HI = 79;
enum R_TILEPRO_IMM16_X0_TLS_IE_HA = 80;
enum R_TILEPRO_IMM16_X1_TLS_IE_HA = 81;
enum R_TILEPRO_TLS_DTPMOD32 =  82;
enum R_TILEPRO_TLS_DTPOFF32 =  83;
enum R_TILEPRO_TLS_TPOFF32 =   84;
enum R_TILEPRO_IMM16_X0_TLS_LE = 85;
enum R_TILEPRO_IMM16_X1_TLS_LE = 86;
enum R_TILEPRO_IMM16_X0_TLS_LE_LO = 87;
enum R_TILEPRO_IMM16_X1_TLS_LE_LO = 88;
enum R_TILEPRO_IMM16_X0_TLS_LE_HI = 89;
enum R_TILEPRO_IMM16_X1_TLS_LE_HI = 90;
enum R_TILEPRO_IMM16_X0_TLS_LE_HA = 91;
enum R_TILEPRO_IMM16_X1_TLS_LE_HA = 92;

enum R_TILEPRO_GNU_VTINHERIT = 128;
enum R_TILEPRO_GNU_VTENTRY =   129;

enum R_TILEPRO_NUM =           130;
enum R_TILEGX_NONE =           0;
enum R_TILEGX_64 =             1;
enum R_TILEGX_32 =             2;
enum R_TILEGX_16 =             3;
enum R_TILEGX_8 =              4;
enum R_TILEGX_64_PCREL =       5;
enum R_TILEGX_32_PCREL =       6;
enum R_TILEGX_16_PCREL =       7;
enum R_TILEGX_8_PCREL =        8;
enum R_TILEGX_HW0 =            9;
enum R_TILEGX_HW1 =            10;
enum R_TILEGX_HW2 =            11;
enum R_TILEGX_HW3 =            12;
enum R_TILEGX_HW0_LAST =       13;
enum R_TILEGX_HW1_LAST =       14;
enum R_TILEGX_HW2_LAST =       15;
enum R_TILEGX_COPY =           16;
enum R_TILEGX_GLOB_DAT =       17;
enum R_TILEGX_JMP_SLOT =       18;
enum R_TILEGX_RELATIVE =       19;
enum R_TILEGX_BROFF_X1 =       20;
enum R_TILEGX_JUMPOFF_X1 =     21;
enum R_TILEGX_JUMPOFF_X1_PLT = 22;
enum R_TILEGX_IMM8_X0 =        23;
enum R_TILEGX_IMM8_Y0 =        24;
enum R_TILEGX_IMM8_X1 =        25;
enum R_TILEGX_IMM8_Y1 =        26;
enum R_TILEGX_DEST_IMM8_X1 =   27;
enum R_TILEGX_MT_IMM14_X1 =    28;
enum R_TILEGX_MF_IMM14_X1 =    29;
enum R_TILEGX_MMSTART_X0 =     30;
enum R_TILEGX_MMEND_X0 =       31;
enum R_TILEGX_SHAMT_X0 =       32;
enum R_TILEGX_SHAMT_X1 =       33;
enum R_TILEGX_SHAMT_Y0 =       34;
enum R_TILEGX_SHAMT_Y1 =       35;
enum R_TILEGX_IMM16_X0_HW0 =   36;
enum R_TILEGX_IMM16_X1_HW0 =   37;
enum R_TILEGX_IMM16_X0_HW1 =   38;
enum R_TILEGX_IMM16_X1_HW1 =   39;
enum R_TILEGX_IMM16_X0_HW2 =   40;
enum R_TILEGX_IMM16_X1_HW2 =   41;
enum R_TILEGX_IMM16_X0_HW3 =   42;
enum R_TILEGX_IMM16_X1_HW3 =   43;
enum R_TILEGX_IMM16_X0_HW0_LAST = 44;
enum R_TILEGX_IMM16_X1_HW0_LAST = 45;
enum R_TILEGX_IMM16_X0_HW1_LAST = 46;
enum R_TILEGX_IMM16_X1_HW1_LAST = 47;
enum R_TILEGX_IMM16_X0_HW2_LAST = 48;
enum R_TILEGX_IMM16_X1_HW2_LAST = 49;
enum R_TILEGX_IMM16_X0_HW0_PCREL = 50;
enum R_TILEGX_IMM16_X1_HW0_PCREL = 51;
enum R_TILEGX_IMM16_X0_HW1_PCREL = 52;
enum R_TILEGX_IMM16_X1_HW1_PCREL = 53;
enum R_TILEGX_IMM16_X0_HW2_PCREL = 54;
enum R_TILEGX_IMM16_X1_HW2_PCREL = 55;
enum R_TILEGX_IMM16_X0_HW3_PCREL = 56;
enum R_TILEGX_IMM16_X1_HW3_PCREL = 57;
enum R_TILEGX_IMM16_X0_HW0_LAST_PCREL = 58;
enum R_TILEGX_IMM16_X1_HW0_LAST_PCREL = 59;
enum R_TILEGX_IMM16_X0_HW1_LAST_PCREL = 60;
enum R_TILEGX_IMM16_X1_HW1_LAST_PCREL = 61;
enum R_TILEGX_IMM16_X0_HW2_LAST_PCREL = 62;
enum R_TILEGX_IMM16_X1_HW2_LAST_PCREL = 63;
enum R_TILEGX_IMM16_X0_HW0_GOT = 64;
enum R_TILEGX_IMM16_X1_HW0_GOT = 65;
enum R_TILEGX_IMM16_X0_HW0_PLT_PCREL = 66;
enum R_TILEGX_IMM16_X1_HW0_PLT_PCREL = 67;
enum R_TILEGX_IMM16_X0_HW1_PLT_PCREL = 68;
enum R_TILEGX_IMM16_X1_HW1_PLT_PCREL = 69;
enum R_TILEGX_IMM16_X0_HW2_PLT_PCREL = 70;
enum R_TILEGX_IMM16_X1_HW2_PLT_PCREL = 71;
enum R_TILEGX_IMM16_X0_HW0_LAST_GOT = 72;
enum R_TILEGX_IMM16_X1_HW0_LAST_GOT = 73;
enum R_TILEGX_IMM16_X0_HW1_LAST_GOT = 74;
enum R_TILEGX_IMM16_X1_HW1_LAST_GOT = 75;
enum R_TILEGX_IMM16_X0_HW3_PLT_PCREL = 76;
enum R_TILEGX_IMM16_X1_HW3_PLT_PCREL = 77;
enum R_TILEGX_IMM16_X0_HW0_TLS_GD = 78;
enum R_TILEGX_IMM16_X1_HW0_TLS_GD = 79;
enum R_TILEGX_IMM16_X0_HW0_TLS_LE = 80;
enum R_TILEGX_IMM16_X1_HW0_TLS_LE = 81;
enum R_TILEGX_IMM16_X0_HW0_LAST_TLS_LE = 82;
enum R_TILEGX_IMM16_X1_HW0_LAST_TLS_LE = 83;
enum R_TILEGX_IMM16_X0_HW1_LAST_TLS_LE = 84;
enum R_TILEGX_IMM16_X1_HW1_LAST_TLS_LE = 85;
enum R_TILEGX_IMM16_X0_HW0_LAST_TLS_GD = 86;
enum R_TILEGX_IMM16_X1_HW0_LAST_TLS_GD = 87;
enum R_TILEGX_IMM16_X0_HW1_LAST_TLS_GD = 88;
enum R_TILEGX_IMM16_X1_HW1_LAST_TLS_GD = 89;
enum R_TILEGX_IMM16_X0_HW0_TLS_IE = 92;
enum R_TILEGX_IMM16_X1_HW0_TLS_IE = 93;
enum R_TILEGX_IMM16_X0_HW0_LAST_PLT_PCREL = 94;
enum R_TILEGX_IMM16_X1_HW0_LAST_PLT_PCREL = 95;
enum R_TILEGX_IMM16_X0_HW1_LAST_PLT_PCREL = 96;
enum R_TILEGX_IMM16_X1_HW1_LAST_PLT_PCREL = 97;
enum R_TILEGX_IMM16_X0_HW2_LAST_PLT_PCREL = 98;
enum R_TILEGX_IMM16_X1_HW2_LAST_PLT_PCREL = 99;
enum R_TILEGX_IMM16_X0_HW0_LAST_TLS_IE = 100;
enum R_TILEGX_IMM16_X1_HW0_LAST_TLS_IE = 101;
enum R_TILEGX_IMM16_X0_HW1_LAST_TLS_IE = 102;
enum R_TILEGX_IMM16_X1_HW1_LAST_TLS_IE = 103;
enum R_TILEGX_TLS_DTPMOD64 =   106;
enum R_TILEGX_TLS_DTPOFF64 =   107;
enum R_TILEGX_TLS_TPOFF64 =    108;
enum R_TILEGX_TLS_DTPMOD32 =   109;
enum R_TILEGX_TLS_DTPOFF32 =   110;
enum R_TILEGX_TLS_TPOFF32 =    111;
enum R_TILEGX_TLS_GD_CALL =    112;
enum R_TILEGX_IMM8_X0_TLS_GD_ADD = 113;
enum R_TILEGX_IMM8_X1_TLS_GD_ADD = 114;
enum R_TILEGX_IMM8_Y0_TLS_GD_ADD = 115;
enum R_TILEGX_IMM8_Y1_TLS_GD_ADD = 116;
enum R_TILEGX_TLS_IE_LOAD =    117;
enum R_TILEGX_IMM8_X0_TLS_ADD = 118;
enum R_TILEGX_IMM8_X1_TLS_ADD = 119;
enum R_TILEGX_IMM8_Y0_TLS_ADD = 120;
enum R_TILEGX_IMM8_Y1_TLS_ADD = 121;

enum R_TILEGX_GNU_VTINHERIT =  128;
enum R_TILEGX_GNU_VTENTRY =    129;

enum R_TILEGX_NUM =            130;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           /**
 * D header file to interface with the Linux epoll API (http://man7.org/linux/man-pages/man7/epoll.7.html).
 * Available since Linux 2.6
 *
 * Copyright: Copyright Adil Baig 2012.
 * License : $(LINK2 http://www.boost.org/LICENSE_1_0.txt, Boost License 1.0)
 * Authors  : Adil Baig (github.com/adilbaig)
 */
module core.sys.linux.epoll;

version (linux):

extern (C):
@system:
@nogc:
nothrow:

version (ARM)     version = ARM_Any;
version (AArch64) version = ARM_Any;
version (HPPA)    version = HPPA_Any;
version (MIPS32)  version = MIPS_Any;
version (MIPS64)  version = MIPS_Any;
version (PPC)     version = PPC_Any;
version (PPC64)   version = PPC_Any;
version (RISCV32) version = RISCV_Any;
version (RISCV64) version = RISCV_Any;
version (S390)    version = IBMZ_Any;
version (SPARC)   version = SPARC_Any;
version (SPARC64) version = SPARC_Any;
version (SystemZ) version = IBMZ_Any;
version (X86)     version = X86_Any;
version (X86_64)  version = X86_Any;

enum
{
    EPOLL_CLOEXEC  = 0x80000,
    EPOLL_NONBLOCK = 0x800
}

enum
{
    EPOLLIN     = 0x001,
    EPOLLPRI    = 0x002,
    EPOLLOUT    = 0x004,
    EPOLLRDNORM = 0x040,
    EPOLLRDBAND = 0x080,
    EPOLLWRNORM = 0x100,
    EPOLLWRBAND = 0x200,
    EPOLLMSG    = 0x400,
    EPOLLERR    = 0x008,
    EPOLLHUP    = 0x010,
    EPOLLRDHUP  = 0x2000, // since Linux 2.6.17
    EPOLLEXCLUSIVE = 1u << 28, // since Linux 4.5
    EPOLLONESHOT = 1u << 30,
    EPOLLET     = 1u << 31
}

/* Valid opcodes ( "op" parameter ) to issue to epoll_ctl().  */
enum
{
    EPOLL_CTL_ADD = 1, // Add a file descriptor to the interface.
    EPOLL_CTL_DEL = 2, // Remove a file descriptor from the interface.
    EPOLL_CTL_MOD = 3, // Change file descriptor epoll_event structure.
}

version (X86_Any)
{
    align(1) struct epoll_event
    {
    align(1):
        uint events;
        epoll_data_t data;
    }
}
else version (ARM_Any)
{
    struct epoll_event
    {
        uint events;
        epoll_data_t data;
    }
}
else version (PPC_Any)
{
    struct epoll_event
    {
        uint events;
        epoll_data_t data;
    }
}
else version (HPPA_Any)
{
    struct epoll_event
    {
        uint events;
        epoll_data_t data;
    }
}
else version (MIPS_Any)
{
    struct epoll_event
    {
        uint events;
        epoll_data_t data;
    }
}
else version (RISCV_Any)
{
    struct epoll_event
    {
        uint events;
        epoll_data_t data;
    }
}
else version (SPARC_Any)
{
    struct epoll_event
    {
        uint events;
        epoll_data_t data;
    }
}
else version (IBMZ_Any)
{
    struct epoll_event
    {
        uint events;
        epoll_data_t data;
    }
}
else
{
    static assert(false, "Platform not supported");
}

union epoll_data_t
{
    void *ptr;
    int fd;
    uint u32;
    ulong u64;
}

int epoll_create (int size);
int epoll_create1 (int flags);
int epoll_ctl (int epfd, int op, int fd, epoll_event *event);
int epoll_wait (int epfd, epoll_event *events, int maxevents, int timeout);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /**
 * D header file for GNU/Linux
 *
 * $(LINK2 http://sourceware.org/git/?p=glibc.git;a=blob;f=stdlib/errno.h, glibc stdlib/errno.h)
 */
module core.sys.linux.errno;

version (linux):
extern (C):
nothrow:

public import core.stdc.errno;
import core.sys.linux.config;

static if (__USE_GNU)
{
    extern __gshared char* program_invocation_name, program_invocation_short_name;
    alias error_t = int;
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            /**
 * D header file for GNU/Linux.
 *
 * Copyright: Copyright Martin Nowak 2012.
 * License:   $(LINK2 http://www.boost.org/LICENSE_1_0.txt, Boost License 1.0)
 * Authors:   Martin Nowak
 */
module core.sys.linux.execinfo;

version (linux):
extern (C):
nothrow:

int backtrace(void** buffer, int size);
char** backtrace_symbols(const(void*)* buffer, int size);
void backtrace_symbols_fd(const(void*)* buffer, int size, int fd);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   module core.sys.linux.fcntl;

public import core.sys.posix.fcntl;

version (linux):
extern(C):
nothrow:

// From linux/falloc.h
/// fallocate(2) params
enum {
    /// Allocates and initializes to zero the disk space
    /// within the specified range, but the file size
    /// will not be modified.
    FALLOC_FL_KEEP_SIZE = 0x01,
    /// Deallocates space (i.e. creates a hole)
    FALLOC_FL_PUNCH_HOLE = 0x02,
    /// Newly allocated blocks will be marked as initialized.
    FALLOC_FL_NO_HIDE_STALE = 0x04,
    /// Removes a byte range from a file, without leaving a hole
    FALLOC_FL_COLLAPSE_RANGE = 0x08,
    /// Zeroes space in the specified byte range
    FALLOC_FL_ZERO_RANGE = 0x10,
    /// Increases the file space by inserting a hole
    /// without overwriting any existing data
    FALLOC_FL_INSERT_RANGE = 0x20,
    /// Used to unshare shared blocks within
    /// the file size without overwriting any existing data
    FALLOC_FL_UNSHARE_RANGE = 0x40
}

// From asm-generic/fcntl.h
/**

Open File Description locks

Usually record locks held by a process are released on *any* close and are
not inherited across a fork().

These cmd values will set locks that conflict with process-associated
record  locks, but are "owned" by the open file description, not the
process. This means that they are inherited across fork() like BSD (flock)
locks, and they are only released automatically when the last reference to
the the open file against which they were acquired is put.

*/
enum
{
    /// Queries the system if the lock could be placed
    F_OFD_GETLK  = 36,
    /// Acquires or releases an open file description lock
    F_OFD_SETLK  = 37,
    /// Same as F_OFD_SETLK, but waits if a conflicting lock is held on the file
    F_OFD_SETLKW = 38
}

// Linux-specific fallocate
// (http://man7.org/linux/man-pages/man2/fallocate.2.html)
int fallocate(int fd, int mode, off_t offset, off_t len);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /*******************************************************************************

    D binding for the interface addresses querying

    Defines functions getifaddrs/freeifaddrs and the structure
    they operate on.

    getifaddrs(3)   get interface addresses
    freeifaddrs(3)  deallocates the structure returned from getifaddrs

    Copyright:  Copyright (c) 2016 Sociomantic Labs. All rights reserved.
    License:    $(HTTP www.boost.org/LICENSE_1_0.txt, Boost License 1.0).
    Authors:    Nemanja Boric

*******************************************************************************/

module core.sys.linux.ifaddrs;

import core.sys.posix.sys.socket;

version (linux):
extern (C):
nothrow:
@nogc:

struct ifaddrs
{
    /// Next item in the list
    ifaddrs*         ifa_next;
    /// Name of the interface
    char*            ifa_name;
    /// Flags from SIOCGIFFLAGS
    uint      ifa_flags;
    /// Address of interface
    sockaddr* ifa_addr;
    /// Netmask of interface
    sockaddr* ifa_netmask;

    union
    {
        /// Broadcast address of the interface
        sockaddr* ifu_broadaddr;
        /// Point-to-point destination addresss
        sockaddr* if_dstaddr;
    }

    /// Address specific data
    void* ifa_data;
};

/// Returns: linked list of ifaddrs structures describing interfaces
int getifaddrs(ifaddrs** );
/// Frees the linked list returned by getifaddrs
void freeifaddrs(ifaddrs* );
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /**
 * D header file for GNU/Linux
 *
 * $(LINK2 http://sourceware.org/git/?p=glibc.git;a=blob;f=elf/link.h, glibc elf/link.h)
 */
module core.sys.linux.link;

version (linux):
extern (C):
nothrow:

version (ARM)     version = ARM_Any;
version (AArch64) version = ARM_Any;
version (HPPA)    version = HPPA_Any;
version (MIPS32)  version = MIPS_Any;
version (MIPS64)  version = MIPS_Any;
version (PPC)     version = PPC_Any;
version (PPC64)   version = PPC_Any;
version (RISCV32) version = RISCV_Any;
version (RISCV64) version = RISCV_Any;
version (S390)    version = IBMZ_Any;
version (SPARC)   version = SPARC_Any;
version (SPARC64) version = SPARC_Any;
version (SystemZ) version = IBMZ_Any;
version (X86)     version = X86_Any;
version (X86_64)  version = X86_Any;

import core.stdc.stdint : uintptr_t, uint32_t, uint64_t;
import core.sys.linux.config : __WORDSIZE;
import core.sys.linux.dlfcn : Lmid_t;
import core.sys.linux.elf;

// <bits/elfclass.h>
version (X86_Any)
{
    // http://sourceware.org/git/?p=glibc.git;a=blob;f=bits/elfclass.h
    alias __WORDSIZE __ELF_NATIVE_CLASS;
    alias uint32_t Elf_Symndx;
}
else version (HPPA_Any)
{
    // http://sourceware.org/git/?p=glibc.git;a=blob;f=bits/elfclass.h
    alias __WORDSIZE __ELF_NATIVE_CLASS;
    alias uint32_t Elf_Symndx;
}
else version (MIPS_Any)
{
    // http://sourceware.org/git/?p=glibc.git;a=blob;f=bits/elfclass.h
    alias __WORDSIZE __ELF_NATIVE_CLASS;
    alias uint32_t Elf_Symndx;
}
else version (PPC_Any)
{
    // http://sourceware.org/git/?p=glibc.git;a=blob;f=bits/elfclass.h
    alias __WORDSIZE __ELF_NATIVE_CLASS;
    alias uint32_t Elf_Symndx;
}
else version (ARM_Any)
{
    // http://sourceware.org/git/?p=glibc.git;a=blob;f=bits/elfclass.h
    alias __WORDSIZE __ELF_NATIVE_CLASS;
    alias uint32_t Elf_Symndx;
}
else version (RISCV_Any)
{
    // http://sourceware.org/git/?p=glibc.git;a=blob;f=bits/elfclass.h
    alias __WORDSIZE __ELF_NATIVE_CLASS;
    alias uint32_t Elf_Symndx;
}
else version (SPARC_Any)
{
    // http://sourceware.org/git/?p=glibc.git;a=blob;f=bits/elfclass.h
    alias __WORDSIZE __ELF_NATIVE_CLASS;
    alias uint32_t Elf_Symndx;
}
else version (IBMZ_Any)
{
    // http://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/s390/bits/elfclass.h
    alias __WORDSIZE __ELF_NATIVE_CLASS;
    static if (__WORDSIZE == 64)
        alias uint64_t Elf_Symndx;
    else
        alias uint32_t Elf_Symndx;
}
else
    static assert(0, "unimplemented");
// <bits/elfclass.h>

template ElfW(string type)
{
    mixin("alias Elf"~__ELF_NATIVE_CLASS.stringof~"_"~type~" ElfW;");
}

enum
{
    RT_CONSISTENT,
    RT_ADD,
    RT_DELETE,
}

struct r_debug
{
    int r_version;
    link_map* r_map;
    ElfW!"Addr" r_brk;
    typeof(RT_CONSISTENT) r_state;
    ElfW!"Addr" r_ldbase;
}

extern r_debug _r_debug;
extern ElfW!"Dyn"* _DYNAMIC;

struct link_map
{
    ElfW!"Addr" l_addr;
    char* l_name;
    ElfW!"Dyn"* l_ld;
    link_map* l_next, l_prev;
}

enum
{
    LA_ACT_CONSISTENT,
    LA_ACT_ADD,
    LA_ACT_DELETE,
}

enum
{
    LA_SER_ORIG = 0x01,
    LA_SER_LIBPATH = 0x02,
    LA_SER_RUNPATH = 0x04,
    LA_SER_CONFIG = 0x08,
    LA_SER_DEFAULT = 0x40,
    LA_SER_SECURE = 0x80,
}


enum
{
    LA_FLG_BINDTO = 0x01,
    LA_FLG_BINDFROM = 0x02,
}


enum
{
    LA_SYMB_NOPLTENTER = 0x01,
    LA_SYMB_NOPLTEXIT = 0x02,
    LA_SYMB_STRUCTCALL = 0x04,
    LA_SYMB_DLSYM = 0x08,
    LA_SYMB_ALTVALUE = 0x10,
}

struct dl_phdr_info
{
    ElfW!"Addr" dlpi_addr;
    const(char)* dlpi_name;
    const(ElfW!"Phdr")* dlpi_phdr;
    ElfW!"Half" dlpi_phnum;

    // check the SIZE argument of the dl_iterate_phdr callback whether
    // the following members are available
    ulong dlpi_adds;
    ulong dlpi_subs;

    size_t dlpi_tls_modid;
    void *dlpi_tls_data;
}

private alias extern(C) int function(dl_phdr_info*, size_t, void *) dl_iterate_phdr_cb;
private alias extern(C) int function(dl_phdr_info*, size_t, void *) @nogc dl_iterate_phdr_cb_ngc;
extern int dl_iterate_phdr(dl_iterate_phdr_cb __callback, void*__data);
extern int dl_iterate_phdr(dl_iterate_phdr_cb_ngc __callback, void*__data) @nogc;

// ld.so auditing interfaces prototypes have to be defined by the auditing DSO.
extern uint la_version(uint __version);
extern void la_activity(uintptr_t *__cookie, uint __flag);
extern char* la_objsearch(const(char)* __name, uintptr_t* __cookie,
                          uint __flag);
extern uint la_objopen(link_map* __map, Lmid_t __lmid,
                       uintptr_t* __cookie);
extern void la_preinit(uintptr_t* __cookie);
extern uintptr_t la_symbind32(Elf32_Sym* __sym, uint __ndx,
                              uintptr_t* __refcook, uintptr_t* __defcook,
                              uint *__flags, const(char)* __symname);
extern uintptr_t la_symbind64(Elf64_Sym* __sym, uint __ndx,
                              uintptr_t* __refcook, uintptr_t* __defcook,
                              uint* __flags, const(char)* __symname);
extern uint la_objclose(uintptr_t *__cookie);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        .      ..     in_.d     Øtcp.d                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           //Written in the D programming language

/++
    D header file for Linux's extensions to POSIX's netinet/in.h.

    Copyright: Copyright 2017 -
    License:   $(HTTP www.boost.org/LICENSE_1_0.txt, Boost License 1.0).
    Authors:   $(HTTP jmdavisprog.com, Jonathan M Davis)
 +/
module core.sys.linux.netinet.in_;

import core.sys.posix.config;

public import core.sys.posix.netinet.in_;

version (CRuntime_Glibc)         version = linux_libc;
else version (CRuntime_Musl)     version = linux_libc;
else version (CRuntime_Bionic)   version = linux_libc;
else version (CRuntime_UClibc)   version = linux_libc;

version (CRuntime_Glibc)         version = gnu_libc;
else version (CRuntime_UClibc)   version = gnu_libc;

version (linux_libc)
{
    extern(C) nothrow @nogc:

    enum IPPROTO_IPIP    = 4;
    enum IPPROTO_EGP     = 8;
    enum IPPROTO_TP      = 29;
    enum IPPROTO_DCCP    = 33;
    enum IPPROTO_RSVP    = 46;
    enum IPPROTO_GRE     = 47;
    enum IPPROTO_ESP     = 50;
    enum IPPROTO_AH      = 51;
    enum IPPROTO_MTP     = 92;
    enum IPPROTO_BEETPH  = 94;
    enum IPPROTO_ENCAP   = 98;
    enum IPPROTO_PIM     = 103;
    enum IPPROTO_COMP    = 108;
    enum IPPROTO_SCTP    = 132;
    enum IPPROTO_UDPLITE = 136;
    enum IPPROTO_MPLS    = 137;

    enum IPPROTO_HOPOPTS  = 0;
    enum IPPROTO_ROUTING  = 43;
    enum IPPROTO_FRAGMENT = 44;
    enum IPPROTO_ICMPV6   = 58;
    enum IPPROTO_NONE     = 59;
    enum IPPROTO_DSTOPTS  = 60;
    enum IPPROTO_MH       = 135;

    enum IPPORT_ECHO       = 7;
    enum IPPORT_DISCARD    = 9;
    enum IPPORT_SYSTAT     = 11;
    enum IPPORT_DAYTIME    = 13;
    enum IPPORT_NETSTAT    = 15;
    enum IPPORT_FTP        = 21;
    enum IPPORT_TELNET     = 23;
    enum IPPORT_SMTP       = 25;
    enum IPPORT_TIMESERVER = 37;
    enum IPPORT_NAMESERVER = 42;
    enum IPPORT_WHOIS      = 43;
    enum IPPORT_MTP        = 57;

    enum IPPORT_TFTP    = 69;
    enum IPPORT_RJE     = 77;
    enum IPPORT_FINGER  = 79;
    enum IPPORT_TTYLINK = 87;
    enum IPPORT_SUPDUP  = 95;

    enum IPPORT_EXECSERVER = 512;
    enum IPPORT_LOGINSERVER = 513;
    enum IPPORT_CMDSERVER = 514;
    enum IPPORT_EFSSERVER = 520;

    enum IPPORT_BIFFUDP = 512;
    enum IPPORT_WHOSERVER = 513;
    enum IPPORT_ROUTESERVER = 520;

    enum IPPORT_RESERVED = 1024;

    enum IPPORT_USERRESERVED = 5000;

    extern(D) bool IN_CLASSA(in_addr_t i) pure @safe { return (i & 0x80000000) == 0; }
    enum IN_CLASSA_NET    = 0xff000000;
    enum IN_CLASSA_NSHIFT = 24;
    enum IN_CLASSA_HOST   = 0xffffffff & ~IN_CLASSA_NET;
    enum IN_CLASSA_MAX    = 128;

    extern(D) bool IN_CLASSB(in_addr_t i) pure @safe { return (i & 0xc0000000) == 0x80000000; }
    enum IN_CLASSB_NET    = 0xffff0000;
    enum IN_CLASSB_NSHIFT = 16;
    enum IN_CLASSB_HOST   = 0xffffffff & ~IN_CLASSB_NET;
    enum IN_CLASSB_MAX    = 65536;

    extern(D) bool IN_CLASSC(in_addr_t i) pure @safe { return (i & 0xe0000000) == 0xc0000000; }
    enum IN_CLASSC_NET    = 0xffffff00;
    enum IN_CLASSC_NSHIFT = 8;
    enum IN_CLASSC_HOST   = 0xffffffff & ~IN_CLASSC_NET;

    extern(D) bool IN_CLASSD(in_addr_t i) pure @safe { return (i & 0xf0000000) == 0xe0000000; }
    extern(D) bool IN_MULTICAST(in_addr_t i) { return IN_CLASSD(i); }

    extern(D) bool IN_EXPERIMENTAL(in_addr_t i) pure @safe { return (i & 0xe0000000) == 0xe0000000; }
    extern(D) bool IN_BADCLASS(in_addr_t i) pure @safe { return (i & 0xf0000000) == 0xf0000000; }

    enum IN_LOOPBACKNET = 127;

    enum INADDR_UNSPEC_GROUP    = 0xe0000000;
    enum INADDR_ALLHOSTS_GROUP  = 0xe0000001;
    enum INADDR_ALLRTRS_GROUP   = 0xe0000002;
    enum INADDR_MAX_LOCAL_GROUP = 0xe00000ff;

    enum IN6ADDR_ANY_INIT      = in6_addr.init;
    enum IN6ADDR_LOOPBACK_INIT = in6_addr([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]);

    version (gnu_libc) static if (__USE_MISC)
    {
        struct ip_mreq
        {
            in_addr imr_multiaddr;
            in_addr imr_interface;
        };

        struct ip_mreq_source
        {
            in_addr imr_multiaddr;
            in_addr imr_interface;
            in_addr imr_sourceaddr;
        };

        struct group_req
        {
            uint gr_interface;
            sockaddr_storage gr_group;
        };

        struct group_source_req
        {
            uint gsr_interface;
            sockaddr_storage gsr_group;
            sockaddr_storage gsr_source;
        };

        struct ip_msfilter
        {
            in_addr imsf_multiaddr;
            in_addr imsf_interface;
            uint imsf_fmode;
            uint imsf_numsrc;
            in_addr[1] imsf_slist;
        };

        extern(D) size_t IP_MSFILTER_SIZE(int numsrc)
        {
            return ip_msfilter.sizeof - in_addr.sizeof + numsrc * in_addr.sizeof;
        }

        struct group_filter
        {
            uint gf_interface;
            sockaddr_storage gf_group;
            uint gf_fmode;
            uint gf_numsrc;
            sockaddr_storage[1] gf_slist;
        };

        extern(D) size_t GROUP_FILTER_SIZE(int numsrc) pure @safe
        {
            return group_filter.sizeof - sockaddr_storage.sizeof + numsrc * sockaddr_storage.sizeof;
        }
    }

    extern(D) bool IN6_ARE_ADDR_EQUAL(in6_addr* a, in6_addr* b) pure @safe { return *a == *b; }

    version (gnu_libc) static if (__USE_MISC)
    {
        int bindresvport(int __sockfd, sockaddr_in* __sock_in);
        int bindresvport6(int __sockfd, sockaddr_in6* _);
    }

    version (gnu_libc) static if (__USE_GNU)
    {
        struct in6_pktinfo
        {
            in6_addr ipi6_addr;
            uint ipi6_ifindex;
        };

        struct ip6_mtuinfo
        {
            sockaddr_in6 ip6m_addr;
            uint ip6m_mtu;
        };

        int inet6_opt_init(void* __extbuf, socklen_t __extlen);
        int inet6_opt_append(void* __extbuf, socklen_t __extlen, int __offset,
                             ubyte __type, socklen_t __len, ubyte __align, void** __databufp);
        int inet6_opt_finish(void* __extbuf, socklen_t __extlen, int __offset);
        int inet6_opt_set_val(void* __databuf, int __offset, void* __val, socklen_t __vallen);
        int inet6_opt_next(void* __extbuf, socklen_t __extlen, int __offset,
                           ubyte* __typep, socklen_t* __lenp, void** __databufp);
        int inet6_opt_find(void* __extbuf, socklen_t __extlen, int __offset,
                           ubyte __type, socklen_t* __lenp, void** __databufp);
        int inet6_opt_get_val(void* __databuf, int __offset, void* __val, socklen_t __vallen);

        socklen_t inet6_rth_space(int __type, int __segments);
        void* inet6_rth_init(void* __bp, socklen_t __bp_len, int __type, int __segments);
        int inet6_rth_add(void* __bp, const in6_addr* __addr);
        int inet6_rth_reverse(const void* __in, void* __out);
        int inet6_rth_segments(const void* __bp);
        in6_addr* inet6_rth_getaddr(const void* __bp, int __index);

        int getipv4sourcefilter(int __s, in_addr __interface_addr, in_addr __group,
                                uint* __fmode, uint* __numsrc, in_addr* __slist);

        int setipv4sourcefilter(int __s, in_addr __interface_addr, in_addr __group,
                                uint __fmode, uint __numsrc, const in_addr* __slist);


        int getsourcefilter(int __s, uint __interface_addr, const sockaddr* __group,
                            socklen_t __grouplen, uint* __fmode, uint* __numsrc,
                            sockaddr_storage* __slist);

        int setsourcefilter(int __s, uint __interface_addr, const sockaddr* __group,
                            socklen_t __grouplen, uint __fmode, uint __numsrc,
                            const sockaddr_storage* __slist);
    }

    // =============================================================================
    // What follows is from bits/in.h, but since bits/in.h specifically says that it
    // should only be #included by #including netinet/in.h, it makes more sense to
    // put them in here so that the way they're imported corresponds with the
    // correct way of #including them in C/C++.
    // =============================================================================

    enum IP_OPTIONS  = 4;
    enum IP_HDRINCL  = 3;
    enum IP_TOS      = 1;
    enum IP_TTL      = 2;
    enum IP_RECVOPTS = 6;

    enum IP_RECVRETOPTS            = IP_RETOPTS;
    enum IP_RETOPTS                = 7;
    enum IP_MULTICAST_IF           = 32;
    enum IP_MULTICAST_TTL          = 33;
    enum IP_MULTICAST_LOOP         = 34;
    enum IP_ADD_MEMBERSHIP         = 35;
    enum IP_DROP_MEMBERSHIP        = 36;
    enum IP_UNBLOCK_SOURCE         = 37;
    enum IP_BLOCK_SOURCE           = 38;
    enum IP_ADD_SOURCE_MEMBERSHIP  = 39;
    enum IP_DROP_SOURCE_MEMBERSHIP = 40;
    enum IP_MSFILTER               = 41;

    version (gnu_libc) static if (__USE_MISC)
    {
        enum MCAST_JOIN_GROUP         = 42;
        enum MCAST_BLOCK_SOURCE       = 43;
        enum MCAST_UNBLOCK_SOURCE     = 44;
        enum MCAST_LEAVE_GROUP        = 45;
        enum MCAST_JOIN_SOURCE_GROUP  = 46;
        enum MCAST_LEAVE_SOURCE_GROUP = 47;
        enum MCAST_MSFILTER           = 48;
        enum IP_MULTICAST_ALL         = 49;
        enum IP_UNICAST_IF            = 50;

        enum MCAST_EXCLUDE = 0;
        enum MCAST_INCLUDE = 1;
    }

    enum IP_ROUTER_ALERT  = 5;
    enum IP_PKTINFO       = 8;
    enum IP_PKTOPTIONS    = 9;
    enum IP_PMTUDISC      = 10;
    enum IP_MTU_DISCOVER  = 10;
    enum IP_RECVERR       = 11;
    enum IP_RECVTTL       = 12;
    enum IP_RECVTOS       = 13;
    enum IP_MTU           = 14;
    enum IP_FREEBIND      = 15;
    enum IP_IPSEC_POLICY  = 16;
    enum IP_XFRM_POLICY   = 17;
    enum IP_PASSSEC       = 18;
    enum IP_TRANSPARENT   = 19;
    enum IP_MULTICAST_ALL = 49;

    enum IP_ORIGDSTADDR     = 20;
    enum IP_RECVORIGDSTADDR = IP_ORIGDSTADDR;

    enum IP_MINTTL               = 21;
    enum IP_NODEFRAG             = 22;
    enum IP_CHECKSUM             = 23;
    enum IP_BIND_ADDRESS_NO_PORT = 24;

    enum IP_PMTUDISC_DONT      = 0;
    enum IP_PMTUDISC_WANT      = 1;
    enum IP_PMTUDISC_DO        = 2;
    enum IP_PMTUDISC_PROBE     = 3;
    enum IP_PMTUDISC_INTERFACE = 4;
    enum IP_PMTUDISC_OMIT      = 5;

    enum SOL_IP = 0;

    enum IP_DEFAULT_MULTICAST_TTL  = 1;
    enum IP_DEFAULT_MULTICAST_LOOP = 1;
    enum IP_MAX_MEMBERSHIPS        = 20;

    version (gnu_libc) static if (__USE_MISC)
    {
        struct ip_opts
        {
            in_addr ip_dst;
            char[40] ip_opts = 0;
        };

        struct ip_mreqn
        {
            in_addr imr_multiaddr;
            in_addr imr_address;
            int imr_ifindex;
        };

        struct in_pktinfo
        {
            int ipi_ifindex;
            in_addr ipi_spec_dst;
            in_addr ipi_addr;
        };
    }

    enum IPV6_ADDRFORM       = 1;
    enum IPV6_2292PKTINFO    = 2;
    enum IPV6_2292HOPOPTS    = 3;
    enum IPV6_2292DSTOPTS    = 4;
    enum IPV6_2292RTHDR      = 5;
    enum IPV6_2292PKTOPTIONS = 6;
    enum IPV6_CHECKSUM       = 7;
    enum IPV6_2292HOPLIMIT   = 8;

    enum IPV6_NEXTHOP        = 9;
    enum IPV6_AUTHHDR        = 10;
    enum IPV6_UNICAST_HOPS   = 16;
    enum IPV6_MULTICAST_IF   = 17;
    enum IPV6_MULTICAST_HOPS = 18;
    enum IPV6_MULTICAST_LOOP = 19;
    enum IPV6_JOIN_GROUP     = 20;
    enum IPV6_LEAVE_GROUP    = 21;
    enum IPV6_ROUTER_ALERT   = 22;
    enum IPV6_MTU_DISCOVER   = 23;
    enum IPV6_MTU            = 24;
    enum IPV6_RECVERR        = 25;
    enum IPV6_V6ONLY         = 26;
    enum IPV6_JOIN_ANYCAST   = 27;
    enum IPV6_LEAVE_ANYCAST  = 28;
    enum IPV6_IPSEC_POLICY   = 34;
    enum IPV6_XFRM_POLICY    = 35;
    enum IPV6_HDRINCL        = 36;

    enum IPV6_RECVPKTINFO  = 49;
    enum IPV6_PKTINFO      = 50;
    enum IPV6_RECVHOPLIMIT = 51;
    enum IPV6_HOPLIMIT     = 52;
    enum IPV6_RECVHOPOPTS  = 53;
    enum IPV6_HOPOPTS      = 54;
    enum IPV6_RTHDRDSTOPTS = 55;
    enum IPV6_RECVRTHDR    = 56;
    enum IPV6_RTHDR        = 57;
    enum IPV6_RECVDSTOPTS  = 58;
    enum IPV6_DSTOPTS      = 59;
    enum IPV6_RECVPATHMTU  = 60;
    enum IPV6_PATHMTU      = 61;
    enum IPV6_DONTFRAG     = 62;

    enum IPV6_RECVTCLASS = 66;
    enum IPV6_TCLASS     = 67;

    enum IPV6_PMTUDISC_DONT      = 0;
    enum IPV6_PMTUDISC_WANT      = 1;
    enum IPV6_PMTUDISC_DO        = 2;
    enum IPV6_PMTUDISC_PROBE     = 3;
    enum IPV6_PMTUDISC_INTERFACE = 4;
    enum IPV6_PMTUDISC_OMIT      = 5;

    enum SOL_IPV6   = 41;
    enum SOL_ICMPV6 = 58;

    enum IPV6_RTHDR_LOOSE  = 0;
    enum IPV6_RTHDR_STRICT = 1;

    enum IPV6_RTHDR_TYPE_0 = 0;
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           /*******************************************************************************

    D bindings for the Linux's netinet/tcp.h structures.

    Defines constants found in tcp.h header on Linux system.

    Copyright:  Copyright (c) 2016 Sociomantic Labs. All rights reserved.
    License:    $(HTTP www.boost.org/LICENSE_1_0.txt, Boost License 1.0).
    Authors:    Nemanja Boric

*******************************************************************************/

module core.sys.linux.netinet.tcp;

/*
* Copyright (c) 1982, 1986, 1993
* The Regents of the University of California.  All rights reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
* 1. Redistributions of source code must retain the above copyright
*    notice, this list of conditions and the following disclaimer.
* 2. Redistributions in binary form must reproduce the above copyright
*    notice, this list of conditions and the following disclaimer in the
*    documentation and/or other materials provided with the distribution.
* 4. Neither the name of the University nor the names of its contributors
*    may be used to endorse or promote products derived from this software
*    without specific prior written permission.
*
* THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
* ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
* IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
* ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
* FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
* OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
* HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
* LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
* OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
* SUCH DAMAGE.
*
* @(#)tcp.h 8.1 (Berkeley) 6/10/93
*/

version (linux):

/// User-settable options (used with setsockopt).
enum
{
     TCP_NODELAY            = 1,  /// Don't delay send to coalesce packets
     TCP_MAXSEG             = 2,  /// Set maximum segment size
     TCP_CORK               = 3,  /// Control sending of partial frames
     TCP_KEEPIDLE           = 4,  /// Start keeplives after this period
     TCP_KEEPINTVL          = 5,  /// Interval between keepalives
     TCP_KEEPCNT            = 6,  /// Number of keepalives before death
     TCP_SYNCNT             = 7,  /// Number of SYN retransmits
     TCP_LINGER2            = 8,  /// Life time of orphaned FIN-WAIT-2 state
     TCP_DEFER_ACCEPT       = 9,  /// Wake up listener only when data arrive
     TCP_WINDOW_CLAMP       = 10, /// Bound advertised window
     TCP_INFO               = 11, /// Information about this connection.
     TCP_QUICKACK           = 12, /// Bock/reenable quick ACKs.
     TCP_CONGESTION         = 13, /// Congestion control algorithm.
     TCP_MD5SIG             = 14, /// TCP MD5 Signature (RFC2385)
     TCP_COOKIE_TRANSACTIONS     = 15, /// TCP Cookie Transactions
     TCP_THIN_LINEAR_TIMEOUTS    = 16, /// Use linear timeouts for thin streams
     TCP_THIN_DUPACK             = 17, /// Fast retrans. after 1 dupack
     TCP_USER_TIMEOUT       = 18, /// How long for loss retry before timeout
     TCP_REPAIR             = 19, /// TCP sock is under repair right now
     TCP_REPAIR_QUEUE       = 20, /// Set TCP queue to repair
     TCP_QUEUE_SEQ          = 21, /// Set sequence number of repaired queue.
     TCP_REPAIR_OPTIONS     = 22, /// Repair TCP connection options
     TCP_FASTOPEN           = 23, /// Enable FastOpen on listeners
     TCP_TIMESTAMP          = 24, /// TCP time stamp
     TCP_NOTSENT_LOWAT      = 25, /// Limit number of unsent bytes in  write queue.
     TCP_CC_INFO            = 26, /// Get Congestion Control (optional) info.
     TCP_SAVE_SYN           = 27, /// Record SYN headers for new connections.
     TCP_SAVED_SYN          = 28, /// Get SYN headers recorded for connection.
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /*******************************************************************************

    D binding for Linux specific scheduler control methods.

    Defines functions sched_setaffinity and sched_getaffinity  and the data
    types they operate on.

    Copyright:  Copyright (c) 2016 Sociomantic Labs. All rights reserved.
    License:    $(HTTP www.boost.org/LICENSE_1_0.txt, Boost License 1.0).
    Authors:    Nemanja Boric

*******************************************************************************/


module core.sys.linux.sched;

import core.bitop : popcnt;
import core.sys.posix.sched;
import core.sys.posix.config;
import core.sys.posix.sys.types;

version (linux):
extern (C):
@nogc:
nothrow:


private // helpers
{

    /* Size definition for CPU sets.  */
    enum
    {
        __CPU_SETSIZE = 1024,
        __NCPUBITS  = 8 * cpu_mask.sizeof,
    }

    /* Macros */

    /* Basic access functions.  */
    size_t __CPUELT(size_t cpu) pure
    {
        return cpu / __NCPUBITS;
    }
    cpu_mask __CPUMASK(size_t cpu) pure
    {
        return 1UL << (cpu % __NCPUBITS);
    }

    cpu_mask __CPU_SET_S(size_t cpu, size_t setsize, cpu_set_t* cpusetp) pure
    {
        if (cpu < 8 * setsize)
        {
            cpusetp.__bits[__CPUELT(cpu)] |= __CPUMASK(cpu);
            return __CPUMASK(cpu);
        }

        return 0;
    }

    bool __CPU_ISSET_S(size_t cpu, size_t setsize, cpu_set_t* cpusetp) pure
    {
        if (cpu < 8 * setsize)
            return (cpusetp.__bits[__CPUELT(cpu)] & __CPUMASK(cpu)) != 0;
        return false;
    }

    int __CPU_COUNT_S(size_t setsize, cpu_set_t* cpusetp) pure
    {
        int s = 0;
        foreach (i; cpusetp.__bits[0 .. (setsize / cpu_mask.sizeof)])
            s += popcnt(i);
        return s;
    }
}

/// Type for array elements in 'cpu_set_t'.
alias c_ulong cpu_mask;

/// Data structure to describe CPU mask.
struct cpu_set_t
{
    cpu_mask[__CPU_SETSIZE / __NCPUBITS] __bits;
}

/// Access macros for 'cpu_set' (missing a lot of them)

cpu_mask CPU_SET(size_t cpu, cpu_set_t* cpusetp) pure
{
     return __CPU_SET_S(cpu, cpu_set_t.sizeof, cpusetp);
}

bool CPU_ISSET(size_t cpu, cpu_set_t* cpusetp) pure
{
    return __CPU_ISSET_S(cpu, cpu_set_t.sizeof, cpusetp);
}

int CPU_COUNT(cpu_set_t* cpusetp) pure
{
    return __CPU_COUNT_S(cpu_set_t.sizeof, cpusetp);
}

/* Functions */
int sched_setaffinity(pid_t pid, size_t cpusetsize, cpu_set_t *mask);
int sched_getaffinity(pid_t pid, size_t cpusetsize, cpu_set_t *mask);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /**
  * D header file for GNU stdio.
  *
  * Copyright: Danny Milosavljevic 2014
  * License: <a href="http://www.boost.org/LICENSE_1_0.txt">Boost License 1.0</a>.
  * Authors: Danny Milosavljevic
  */
module core.sys.linux.stdio;
version (CRuntime_Glibc):
public import core.sys.posix.stdio;
import core.sys.posix.sys.types : ssize_t, off64_t = off_t;
import core.sys.linux.config : __USE_FILE_OFFSET64;
import core.stdc.stdio : FILE;
import core.stdc.stddef : wchar_t;

extern(C) nothrow
{
    alias ssize_t function(void *cookie, char *buf, size_t size) cookie_read_function_t;
    alias ssize_t function(void *cookie, const(char) *buf, size_t size) cookie_write_function_t;
    alias int function(void *cookie, off64_t *offset, int whence) cookie_seek_function_t;
    alias int function(void *cookie) cookie_close_function_t;

    struct cookie_io_functions_t
    {
        cookie_read_function_t read;
        cookie_write_function_t write;
        cookie_seek_function_t seek;
        cookie_close_function_t close;
    }
    FILE* fopencookie(in void* cookie, in char* mode, cookie_io_functions_t io_funcs);
    void setbuffer(FILE *stream, char *buf, size_t size); // note: _DEFAULT_SOURCE
}

unittest
{
    static int flag = 0;
    static int written = 0;
    static int closed = 0;
    // Note: this test needs to run on both a 32 and a 64 bit machine, both have to pass.
    import core.stdc.errno : errno, EBADF;
    //import core.sys.posix.sys.stat : off64_t;
    import core.stdc.stdio : FILE, fflush, fileno, fprintf, fgetc, EOF, fclose;
    import core.stdc.string : memcpy, memset;
    extern (C) ssize_t specialRead(void *cookie, char *buf, size_t size) nothrow
    {
        memset(buf, 'a', size);
        return size;
    }
    extern (C) int specialClose(void* cookie) nothrow
    {
        ++closed;
        return 0;
    }
    extern (C) ssize_t specialWrite(void *cookie, const(char) *buf, size_t size) nothrow
    {
        int* c = cast(int*) cookie;
        flag = *c;
        written += size;
        return size;
    }
    int dummy = 42;
    cookie_io_functions_t fns =
    {
        read: &specialRead,
        write: &specialWrite,
        close: &specialClose,
    };
    FILE* f = fopencookie(&dummy, "r+", fns);
    assert(f !is null);
    //File.open();
    //auto g = File(f);
    assert(fileno(f) == -1 && errno == EBADF);
    assert(fprintf(f, "hello") == "hello".length);
    //assert(errno == EBADF);
    assert(fflush(f) == 0);
    assert(written == "hello".length);
    // Note: do not swap reading and writing here.
    int c = 0;
    while ((c = fgetc(f)) != EOF)
    {
        assert(c == 'a');
        break; // endless otherwise
    }
    assert(c == 'a');
    assert(fclose(f) == 0);
    assert(closed == 1);
    assert(flag == dummy);
    //stdin.getFP();
    //assert(stdin.fileno() == 0);
}

unittest
{ /* setbuffer */
    char buf;
    int c;
    byte[10] dummy = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
    FILE* f = fmemopen(dummy.ptr, 10, "r");
    assert(f !is null);
    setbuffer(f, &buf, 1);
    assert(fgetc(f) == 1);
    assert(fgetc(f) == 2);
    assert(fgetc(f) == 3);
    assert(fgetc(f) == 4);
    assert(fclose(f) == 0);
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   .      ..     auxv.d     	eventfd.d      file.d     	inotify.d      mman.d     netinet    prctl.d    
signalfd.d     socket.d   	sysinfo.d      time.d     (xattr.d                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /**
 * D header file for GNU/Linux.
 *
 * License:   $(LINK2 http://www.boost.org/LICENSE_1_0.txt, Boost License 1.0)
 * Authors:   Kai Nacke
 */
module core.sys.linux.sys.auxv;

import core.stdc.config;

version (linux):
extern (C):

version (MIPS32)  version = MIPS_Any;
version (MIPS64)  version = MIPS_Any;
version (PPC)     version = PPC_Any;
version (PPC64)   version = PPC_Any;
version (S390)    version = IBMZ_Any;
version (SPARC)   version = SPARC_Any;
version (SPARC64) version = SPARC_Any;
version (SystemZ) version = IBMZ_Any;

c_ulong getauxval(c_ulong type) nothrow pure @nogc @system;

version (ARM)
{
  // See https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/arm/bits/hwcap.h

  enum HWCAP_ARM_SWP                      = 1;
  enum HWCAP_ARM_HALF                     = 2;
  enum HWCAP_ARM_THUMB                    = 4;
  enum HWCAP_ARM_26BIT                    = 8;
  enum HWCAP_ARM_FAST_MULT                = 16;
  enum HWCAP_ARM_FPA                      = 32;
  enum HWCAP_ARM_VFP                      = 64;
  enum HWCAP_ARM_EDSP                     = 128;
  enum HWCAP_ARM_JAVA                     = 256;
  enum HWCAP_ARM_IWMMXT                   = 512;
  enum HWCAP_ARM_CRUNCH                   = 1024;
  enum HWCAP_ARM_THUMBEE                  = 2048;
  enum HWCAP_ARM_NEON                     = 4096;
  enum HWCAP_ARM_VFPv3                    = 8192;
  enum HWCAP_ARM_VFPv3D16                 = 16384;
  enum HWCAP_ARM_TLS                      = 32768;
  enum HWCAP_ARM_VFPv4                    = 65536;
  enum HWCAP_ARM_IDIVA                    = 131072;
  enum HWCAP_ARM_IDIVT                    = 262144;
  enum HWCAP_ARM_VFPD32                   = 524288;
  enum HWCAP_ARM_LPAE                     = 1048576;
  enum HWCAP_ARM_EVTSTRM                  = 2097152;
}
else version (AArch64)
{
  // See https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/aarch64/bits/hwcap.h

  enum HWCAP_FP                           = 1;
  enum HWCAP_ASIMD                        = 2;
  enum HWCAP_EVTSTRM                      = 4;
  enum HWCAP_AES                          = 8;
  enum HWCAP_PMULL                        = 16;
  enum HWCAP_SHA1                         = 32;
  enum HWCAP_SHA2                         = 64;
  enum HWCAP_CRC32                        = 128;
  enum HWCAP_ATOMICS                      = 256;
  enum HWCAP_FPHP                         = 512;
  enum HWCAP_ASIMDHP                      = 1024;
}
else version (PPC_Any)
{
  // See https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/powerpc/bits/hwcap.h

  enum PPC_FEATURE_32                     = 0x80000000;
  enum PPC_FEATURE_64                     = 0x40000000;
  enum PPC_FEATURE_601_INSTR              = 0x20000000;
  enum PPC_FEATURE_HAS_ALTIVEC            = 0x10000000;
  enum PPC_FEATURE_HAS_FPU                = 0x08000000;
  enum PPC_FEATURE_HAS_MMU                = 0x04000000;
  enum PPC_FEATURE_HAS_4xxMAC             = 0x02000000;
  enum PPC_FEATURE_UNIFIED_CACHE          = 0x01000000;
  enum PPC_FEATURE_HAS_SPE                = 0x00800000;
  enum PPC_FEATURE_HAS_EFP_SINGLE         = 0x00400000;
  enum PPC_FEATURE_HAS_EFP_DOUBLE         = 0x00200000;
  enum PPC_FEATURE_NO_TB                  = 0x00100000;
  enum PPC_FEATURE_POWER4                 = 0x00080000;
  enum PPC_FEATURE_POWER5                 = 0x00040000;
  enum PPC_FEATURE_POWER5_PLUS            = 0x00020000;
  enum PPC_FEATURE_CELL_BE                = 0x00010000;
  enum PPC_FEATURE_BOOKE                  = 0x00008000;
  enum PPC_FEATURE_SMT                    = 0x00004000;

  enum PPC_FEATURE_ICACHE_SNOOP           = 0x00002000;
  enum PPC_FEATURE_ARCH_2_05              = 0x00001000;
  enum PPC_FEATURE_PA6T                   = 0x00000800;
  enum PPC_FEATURE_HAS_DFP                = 0x00000400;
  enum PPC_FEATURE_POWER6_EXT             = 0x00000200;
  enum PPC_FEATURE_ARCH_2_06              = 0x00000100;
  enum PPC_FEATURE_HAS_VSX                = 0x00000080;
  enum PPC_FEATURE_PSERIES_PERFMON_COMPAT = 0x00000040;
  enum PPC_FEATURE_TRUE_LE                = 0x00000002;
  enum PPC_FEATURE_PPC_LE                 = 0x00000001;

  enum PPC_FEATURE2_ARCH_2_07             = 0x80000000;
  enum PPC_FEATURE2_HAS_HTM               = 0x40000000;
  enum PPC_FEATURE2_HAS_DSCR              = 0x20000000;
  enum PPC_FEATURE2_HAS_EBB               = 0x10000000;
  enum PPC_FEATURE2_HAS_ISEL              = 0x08000000;
  enum PPC_FEATURE2_HAS_TAR               = 0x04000000;
  enum PPC_FEATURE2_HAS_VEC_CRYPTO        = 0x02000000;
}
else version (SPARC_Any)
{
  // See https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/sparc/bits/hwcap.h

  enum HWCAP_SPARC_FLUSH                  = 0x00000001;
  enum HWCAP_SPARC_STBAR                  = 0x00000002;
  enum HWCAP_SPARC_SWAP                   = 0x00000004;
  enum HWCAP_SPARC_MULDIV                 = 0x00000008;
  enum HWCAP_SPARC_V9                     = 0x00000010;
  enum HWCAP_SPARC_ULTRA3                 = 0x00000020;
  enum HWCAP_SPARC_BLKINIT                = 0x00000040;
  enum HWCAP_SPARC_N2                     = 0x00000080;
  enum HWCAP_SPARC_MUL32                  = 0x00000100;
  enum HWCAP_SPARC_DIV32                  = 0x00000200;
  enum HWCAP_SPARC_FSMULD                 = 0x00000400;
  enum HWCAP_SPARC_V8PLUS                 = 0x00000800;
  enum HWCAP_SPARC_POPC                   = 0x00001000;
  enum HWCAP_SPARC_VIS                    = 0x00002000;
  enum HWCAP_SPARC_VIS2                   = 0x00004000;
  enum HWCAP_SPARC_ASI_BLK_INIT           = 0x00008000;
  enum HWCAP_SPARC_FMAF                   = 0x00010000;
  enum HWCAP_SPARC_VIS3                   = 0x00020000;
  enum HWCAP_SPARC_HPC                    = 0x00040000;
  enum HWCAP_SPARC_RANDOM                 = 0x00080000;
  enum HWCAP_SPARC_TRANS                  = 0x00100000;
  enum HWCAP_SPARC_FJFMAU                 = 0x00200000;
  enum HWCAP_SPARC_IMA                    = 0x00400000;
  enum HWCAP_SPARC_ASI_CACHE_SPARING      = 0x00800000;
  enum HWCAP_SPARC_PAUSE                  = 0x01000000;
  enum HWCAP_SPARC_CBCOND                 = 0x02000000;
  enum HWCAP_SPARC_CRYPTO                 = 0x04000000;
}
else version (IBMZ_Any)
{
  // See https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/s390/bits/hwcap.h

  enum HWCAP_S390_ESAN3                   = 1;
  enum HWCAP_S390_ZARCH                   = 2;
  enum HWCAP_S390_STFLE                   = 4;
  enum HWCAP_S390_MSA                     = 8;
  enum HWCAP_S390_LDISP                   = 16;
  enum HWCAP_S390_EIMM                    = 32;
  enum HWCAP_S390_DFP                     = 64;
  enum HWCAP_S390_HPAGE                   = 128;
  enum HWCAP_S390_ETF3EH                  = 256;
  enum HWCAP_S390_HIGH_GPRS               = 512;
  enum HWCAP_S390_TE                      = 1024;
  enum HWCAP_S390_VX                      = 2048;
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           /**
 * D header file for GNU/Linux.
 *
 * License:   $(LINK2 http://www.boost.org/LICENSE_1_0.txt, Boost License 1.0)
 * Authors:   Nemanja Boric
 */
module core.sys.linux.sys.eventfd;

version (linux):
extern (C):
@nogc:
@system:
nothrow:

version (ARM)     version = ARM_Any;
version (AArch64) version = ARM_Any;
version (HPPA)    version = HPPA_Any;
version (MIPS32)  version = MIPS_Any;
version (MIPS64)  version = MIPS_Any;
version (PPC)     version = PPC_Any;
version (PPC64)   version = PPC_Any;
version (RISCV32) version = RISCV_Any;
version (RISCV64) version = RISCV_Any;
version (S390)    version = IBMZ_Any;
version (SPARC)   version = SPARC_Any;
version (SPARC64) version = SPARC_Any;
version (SystemZ) version = IBMZ_Any;
version (X86)     version = X86_Any;
version (X86_64)  version = X86_Any;

import core.stdc.stdint: uint64_t;

/// Type for the event counter
alias uint64_t eventfd_t;

/* Return file descriptor for generic event channel.  Set initial
   value to count.  */
int eventfd (uint count, int flags);

/* Read event counter and possibly wait for events.  */
int eventfd_read (int fd, eventfd_t* value);

/* Increment event counter.  */
int eventfd_write (int fd, eventfd_t value);

version (CRuntime_UClibc)
{
    version (MIPS_Any)
    {
        enum EFD_SEMAPHORE = 1;
        enum EFD_CLOEXEC = 0x80000; // octal!02000000
        enum EFD_NONBLOCK = 0x80; // octal!00000200
    }
    else version (SPARC_Any)
    {
        enum EFD_SEMAPHORE = 1;
        enum EFD_CLOEXEC = 0x400000;
        enum EFD_NONBLOCK = 0x004000;
    }
    else
    {
        enum EFD_SEMAPHORE = 1;
        enum EFD_CLOEXEC = 0x80000; // octal!02000000
        enum EFD_NONBLOCK = 0x800; // octal!00004000
    }
}
else version (X86_Any)
{
    enum EFD_SEMAPHORE = 1;
    enum EFD_CLOEXEC = 0x80000; // octal!2000000
    enum EFD_NONBLOCK = 0x800; // octal!4000
}
else version (HPPA_Any)
{
    enum EFD_SEMAPHORE = 1;
    enum EFD_CLOEXEC = 0x200000; // octal!10000000
    enum EFD_NONBLOCK = 0x10004; // octal!00200004
}
else version (MIPS_Any)
{
    enum EFD_SEMAPHORE = 1;
    enum EFD_CLOEXEC = 0x80000; // octal!2000000
    enum EFD_NONBLOCK = 0x80; // octal!200
}
else version (PPC_Any)
{
    enum EFD_SEMAPHORE = 1;
    enum EFD_CLOEXEC = 0x80000; // octal!2000000
    enum EFD_NONBLOCK = 0x800; // octal!4000
}
else version (ARM_Any)
{
    enum EFD_SEMAPHORE = 1;
    enum EFD_CLOEXEC = 0x80000; // octal!2000000
    enum EFD_NONBLOCK = 0x800; // octal!4000
}
else version (RISCV_Any)
{
    enum EFD_SEMAPHORE = 1;
    enum EFD_CLOEXEC = 0x80000; // octal!2000000
    enum EFD_NONBLOCK = 0x800; // octal!4000
}
else version (SPARC_Any)
{
    enum EFD_SEMAPHORE = 1;
    enum EFD_CLOEXEC = 0x80000; // octal!2000000
    enum EFD_NONBLOCK = 0x800; // octal!4000
}
else version (IBMZ_Any)
{
    enum EFD_SEMAPHORE = 1;
    enum EFD_CLOEXEC = 0x80000; // octal!2000000
    enum EFD_NONBLOCK = 0x800; // octal!4000
}
else
    static assert(0, "unimplemented");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /**
 * D header file for Linux file ops.
 *
 * Copyright: Copyright Nemanja Boric 2016.
 * License:   $(HTTP www.boost.org/LICENSE_1_0.txt, Boost License 1.0).
 * Authors:   Nemanja Boric
 */
module core.sys.linux.sys.file;

version (linux):
extern (C):
nothrow:
@nogc:

/* Operations for the `flock' call. */
/// Shared lock
enum LOCK_SH              = 0x01;
/// Exclusive lock
enum LOCK_EX              = 0x02;
/// Unlock
enum LOCK_UN              = 0x08;

/// Don't block when locking.
/// Can be OR'd into one of the above.
enum LOCK_NB              = 0x04;

/// Apply or remove an advisory lock on an open file
/// Params:
///     fd = file to apply or remove lock from
///     operation = lock operation to perform
/// Returns:
///     0 on success, -1 on failure, with .errno
///     set appropriately.
int     flock(int fd, int operation) @trusted;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /**
 * D header file for GNU/Linux.
 *
 * License:   $(LINK2 http://www.boost.org/LICENSE_1_0.txt, Boost License 1.0)
 * Authors:   Gary Willoughby
 */
module core.sys.linux.sys.inotify;

version (linux):
extern (C):
@system:
nothrow:

version (ARM)     version = ARM_Any;
version (AArch64) version = ARM_Any;
version (HPPA)    version = HPPA_Any;
version (MIPS32)  version = MIPS_Any;
version (MIPS64)  version = MIPS_Any;
version (PPC)     version = PPC_Any;
version (PPC64)   version = PPC_Any;
version (RISCV32) version = RISCV_Any;
version (RISCV64) version = RISCV_Any;
version (S390)    version = IBMZ_Any;
version (SPARC)   version = SPARC_Any;
version (SPARC64) version = SPARC_Any;
version (SystemZ) version = IBMZ_Any;
version (X86)     version = X86_Any;
version (X86_64)  version = X86_Any;

struct inotify_event
{
    int wd;
    uint mask;
    uint cookie;
    uint len;
    char[0] name;

    @disable this(this);
}

enum: uint
{
    IN_ACCESS        = 0x00000000,
    IN_MODIFY        = 0x00000002,
    IN_ATTRIB        = 0x00000004,
    IN_CLOSE_WRITE   = 0x00000008,
    IN_CLOSE_NOWRITE = 0x00000010,
    IN_OPEN          = 0x00000020,
    IN_MOVED_FROM    = 0x00000040,
    IN_MOVED_TO      = 0x00000080,
    IN_CREATE        = 0x00000100,
    IN_DELETE        = 0x00000200,
    IN_DELETE_SELF   = 0x00000400,
    IN_MOVE_SELF     = 0x00000800,
    IN_UNMOUNT       = 0x00002000,
    IN_Q_OVERFLOW    = 0x00004000,
    IN_IGNORED       = 0x00008000,
    IN_CLOSE         = 0x00000018,
    IN_MOVE          = 0x000000C0,
    IN_ONLYDIR       = 0x01000000,
    IN_DONT_FOLLOW   = 0x02000000,
    IN_EXCL_UNLINK   = 0x04000000,
    IN_MASK_ADD      = 0x20000000,
    IN_ISDIR         = 0x40000000,
    IN_ONESHOT       = 0x80000000,
    IN_ALL_EVENTS    = 0x80000FFF,
}

// Old typo, preserved for compatibility
enum IN_UMOUNT = IN_UNMOUNT;

version (X86_Any)
{
    enum IN_CLOEXEC = 0x80000; // octal!2000000
    enum IN_NONBLOCK = 0x800; // octal!4000
}
else version (HPPA_Any)
{
    enum IN_CLOEXEC = 0x200000; // octal!10000000
    enum IN_NONBLOCK = 0x10004; // octal!200004
}
else version (MIPS_Any)
{
    enum IN_CLOEXEC = 0x80000; // octal!2000000
    enum IN_NONBLOCK = 0x80; // octal!200
}
else version (PPC_Any)
{
    enum IN_CLOEXEC = 0x80000; // octal!2000000
    enum IN_NONBLOCK = 0x800; // octal!4000
}
else version (ARM_Any)
{
    enum IN_CLOEXEC = 0x80000; // octal!2000000
    enum IN_NONBLOCK = 0x800; // octal!4000
}
else version (RISCV_Any)
{
    enum IN_CLOEXEC = 0x80000; // octal!2000000
    enum IN_NONBLOCK = 0x800; // octal!4000
}
else version (SPARC_Any)
{
    enum IN_CLOEXEC = 0x80000; // octal!2000000
    enum IN_NONBLOCK = 0x800; // octal!4000
}
else version (IBMZ_Any)
{
    enum IN_CLOEXEC = 0x80000; // octal!2000000
    enum IN_NONBLOCK = 0x800; // octal!4000
}
else
    static assert(0, "unimplemented");

int inotify_init();
int inotify_init1(int flags);
int inotify_add_watch(int fd, const(char)* name, uint mask);
int inotify_rm_watch(int fd, uint wd);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           /**
 * D header file for GNU/Linux
 *
 * Authors: Martin Nowak
 */
module core.sys.linux.sys.mman;

version (linux):
extern (C):
nothrow:

version (ARM)     version = ARM_Any;
version (AArch64) version = ARM_Any;
version (HPPA)    version = HPPA_Any;
version (HPPA64)  version = HPPA_Any;
version (MIPS32)  version = MIPS_Any;
version (MIPS64)  version = MIPS_Any;
version (PPC)     version = PPC_Any;
version (PPC64)   version = PPC_Any;
version (RISCV32) version = RISCV_Any;
version (RISCV64) version = RISCV_Any;
version (S390)    version = IBMZ_Any;
version (SPARC)   version = SPARC_Any;
version (SPARC64) version = SPARC_Any;
version (SystemZ) version = IBMZ_Any;
version (X86)     version = X86_Any;
version (X86_64)  version = X86_Any;

public import core.sys.posix.sys.mman;
import core.sys.linux.config;

// <bits/mman.h>
// http://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=sysdeps/unix/sysv/linux/powerpc/bits/mman.h
version (PPC_Any)
{
    enum PROT_SAO = 0x10;

    static if (__USE_MISC) enum
    {
        MAP_GROWSDOWN = 0x00100,
        MAP_DENYWRITE = 0x00800,
        MAP_EXECUTABLE = 0x01000,
        MAP_LOCKED = 0x00080,
        MAP_NORESERVE = 0x00040,
        MAP_POPULATE = 0x08000,
        MAP_NONBLOCK = 0x10000,
        MAP_STACK = 0x20000,
        MAP_HUGETLB = 0x40000,
    }

    // in core.sys.posix.sys.mman
    // enum
    // {
    //     MCL_CURRENT = 0x2000,
    //     MCL_FUTURE = 0x4000,
    // }
}
// https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/riscv/bits/mman.h
else version (RISCV_Any)
{
    static if (__USE_MISC) enum
    {
        MAP_GROWSDOWN = 0x00100,
        MAP_DENYWRITE = 0x00800,
        MAP_EXECUTABLE = 0x01000,
        MAP_LOCKED = 0x02000,
        MAP_NORESERVE = 0x04000,
        MAP_POPULATE = 0x08000,
        MAP_NONBLOCK = 0x10000,
        MAP_STACK = 0x20000,
        MAP_HUGETLB = 0x40000,
        MAP_SYNC = 0x80000,
        MAP_FIXED_NOREPLACE = 0x100000,
    }

    // in core.sys.posix.sys.mman
    // enum
    // {
    //     MCL_CURRENT = 0x2000,
    //     MCL_FUTURE = 0x4000,
    // }
}
// http://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=sysdeps/unix/sysv/linux/s390/bits/mman.h
else version (IBMZ_Any)
{
    static if (__USE_MISC) enum
    {
        MAP_GROWSDOWN = 0x00100,
        MAP_DENYWRITE = 0x00800,
        MAP_EXECUTABLE = 0x01000,
        MAP_LOCKED = 0x02000,
        MAP_NORESERVE = 0x04000,
        MAP_POPULATE = 0x08000,
        MAP_NONBLOCK = 0x10000,
        MAP_STACK = 0x20000,
        MAP_HUGETLB = 0x40000,
    }
}
// http://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=sysdeps/unix/sysv/linux/sh/bits/mman.h
else version (SH)
{
    static if (__USE_MISC) enum
    {
        MAP_GROWSDOWN = 0x0100,
        MAP_DENYWRITE = 0x0800,
        MAP_EXECUTABLE = 0x1000,
        MAP_LOCKED = 0x2000,
        MAP_NORESERVE = 0x4000,
        MAP_POPULATE = 0x8000,
        MAP_NONBLOCK = 0x10000,
        MAP_STACK = 0x20000,
        MAP_HUGETLB = 0x40000,
    }
}
// http://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=sysdeps/unix/sysv/linux/sparc/bits/mman.h
else version (SPARC_Any)
{
    static if (__USE_MISC) enum
    {
        MAP_GROWSDOWN = 0x0200,
        MAP_DENYWRITE = 0x0800,
        MAP_EXECUTABLE = 0x1000,
        MAP_LOCKED = 0x0100,
        MAP_NORESERVE = 0x0040,
        _MAP_NEW = 0x80000000,
        MAP_POPULATE = 0x8000,
        MAP_NONBLOCK = 0x10000,
        MAP_STACK = 0x20000,
        MAP_HUGETLB = 0x40000,
    }

    // in core.sys.posix.sys.mman
    // enum
    // {
    //     MCL_CURRENT = 0x2000,
    //     MCL_FUTURE = 0x4000,
    // }
}
// http://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=sysdeps/unix/sysv/linux/x86/bits/mman.h
else version (X86_Any)
{
    static if (__USE_MISC) enum MAP_32BIT = 0x40;

    static if (__USE_MISC) enum
    {
        MAP_GROWSDOWN = 0x00100,
        MAP_DENYWRITE = 0x00800,
        MAP_EXECUTABLE = 0x01000,
        MAP_LOCKED = 0x02000,
        MAP_NORESERVE = 0x04000,
        MAP_POPULATE = 0x08000,
        MAP_NONBLOCK = 0x10000,
        MAP_STACK = 0x20000,
        MAP_HUGETLB = 0x40000,
    }
}
// http://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=sysdeps/unix/sysv/linux/aarch64/bits/mman.h
else version (AArch64)
{
    static if (__USE_MISC) enum
    {
        MAP_GROWSDOWN = 0x00100,
        MAP_DENYWRITE = 0x00800,
        MAP_EXECUTABLE = 0x01000,
        MAP_LOCKED = 0x02000,
        MAP_NORESERVE = 0x04000,
        MAP_POPULATE = 0x08000,
        MAP_NONBLOCK = 0x10000,
        MAP_STACK = 0x20000,
        MAP_HUGETLB = 0x40000,
    }
}
// http://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=sysdeps/unix/sysv/linux/alpha/bits/mman.h
else version (Alpha)
{
    enum
    {
        PROT_READ = 0x1,
        PROT_WRITE = 0x2,
        PROT_EXEC = 0x4,
        PROT_NONE = 0x0,
        PROT_GROWSDOWN = 0x01000000,
        PROT_GROWSUP = 0x02000000,
    }

    enum MAP_SHARED = 0x01;
    enum MAP_PRIVATE = 0x02;
    static if (__USE_MISC)
        enum MAP_TYPE = 0x0f;

    enum MAP_FIXED = 0x10;
    static if (__USE_MISC) enum
    {
        MAP_FILE = 0,
        MAP_ANONYMOUS = MAP_ANON,
        // in core.sys.posix.sys.mman
        // MAP_ANON = MAP_ANONYMOUS,
        MAP_HUGE_SHIFT = 26,
        MAP_HUGE_MASK = 0x3f,
    }

    static if (__USE_MISC) enum
    {
        MAP_GROWSDOWN = 0x01000,
        MAP_DENYWRITE = 0x02000,
        MAP_EXECUTABLE = 0x04000,
        MAP_LOCKED = 0x08000,
        MAP_NORESERVE = 0x10000,
        MAP_POPULATE = 0x20000,
        MAP_NONBLOCK = 0x40000,
        MAP_STACK = 0x80000,
        MAP_HUGETLB = 0x100000,
    }

    // in core.sys.posix.sys.mman
    // enum
    // {
    //     MS_ASYNC = 1,
    //     MS_SYNC = 2,
    //     MS_INVALIDATE = 4,
    // }

    // in core.sys.posix.sys.mman
    // enum
    // {
    //     MCL_CURRENT = 8192,
    //     MCL_FUTURE = 16384,
    // }

    static if (__USE_GNU) enum
    {
        MREMAP_MAYMOVE = 1,
        MREMAP_FIXED = 2,
    }

    static if (__USE_MISC) enum
    {
        MADV_NORMAL = 0,
        MADV_RANDOM = 1,
        MADV_SEQUENTIAL = 2,
        MADV_WILLNEED = 3,
        MADV_DONTNEED = 6,
        MADV_REMOVE = 9,
        MADV_DONTFORK = 10,
        MADV_DOFORK = 11,
        MADV_MERGEABLE = 12,
        MADV_UNMERGEABLE = 13,
        MADV_HUGEPAGE = 14,
        MADV_NOHUGEPAGE = 15,
        MADV_DONTDUMP = 16,
        MADV_DODUMP = 17,
        MADV_HWPOISON = 100,
    }

    // in core.sys.posix.sys.mman
    // static if (__USE_XOPEN2K) enum
    // {
    //         POSIX_MADV_NORMAL = 0,
    //         POSIX_MADV_RANDOM = 1,
    //         POSIX_MADV_SEQUENTIAL = 2,
    //         POSIX_MADV_WILLNEED = 3,
    //         POSIX_MADV_DONTNEED = 6,
    // }
}
// http://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=sysdeps/unix/sysv/linux/arm/bits/mman.h
else version (ARM)
{
    static if (__USE_MISC) enum
    {
        MAP_GROWSDOWN = 0x00100,
        MAP_DENYWRITE = 0x00800,
        MAP_EXECUTABLE = 0x01000,
        MAP_LOCKED = 0x02000,
        MAP_NORESERVE = 0x04000,
        MAP_POPULATE = 0x08000,
        MAP_NONBLOCK = 0x10000,
        MAP_STACK = 0x20000,
        MAP_HUGETLB = 0x40000,
    }
}
// http://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=sysdeps/unix/sysv/linux/hppa/bits/mman.h
else version (HPPA_Any)
{
    enum
    {
        PROT_READ = 0x1,
        PROT_WRITE = 0x2,
        PROT_EXEC = 0x4,
        PROT_NONE = 0x0,
        PROT_GROWSDOWN = 0x01000000,
        PROT_GROWSUP = 0x02000000,
    }

    enum MAP_SHARED = 0x01;
    enum MAP_PRIVATE = 0x02;
    static if (__USE_MISC)
        enum MAP_TYPE = 0x0f;

    enum MAP_FIXED = 0x04;
    static if (__USE_MISC) enum
    {
        MAP_FILE = 0,
        MAP_ANONYMOUS = MAP_ANON,
        // in core.sys.posix.sys.mman
        // MAP_ANON = MAP_ANONYMOUS,
        MAP_VARIABLE = 0,
        MAP_HUGE_SHIFT = 26,
        MAP_HUGE_MASK = 0x3f,
    }

    static if (__USE_MISC) enum
    {
        MAP_DENYWRITE = 0x0800,
        MAP_EXECUTABLE = 0x1000,
        MAP_LOCKED = 0x2000,
        MAP_NORESERVE = 0x4000,
        MAP_GROWSDOWN = 0x8000,
        MAP_POPULATE = 0x10000,
        MAP_NONBLOCK = 0x20000,
    }

    // in core.sys.posix.sys.mman
    // enum
    // {
    //     MS_ASYNC = 1,
    //     MS_SYNC = 2,
    //     MS_INVALIDATE = 4,
    // }

    // in core.sys.posix.sys.mman
    // enum
    // {
    //     MCL_CURRENT = 1,
    //     MCL_FUTURE = 2,
    // }

    static if (__USE_GNU) enum
    {
        MREMAP_MAYMOVE = 1,
        MREMAP_FIXED = 2,
    }

    static if (__USE_MISC) enum
    {
        MADV_NORMAL = 0,
        MADV_RANDOM = 1,
        MADV_SEQUENTIAL = 2,
        MADV_WILLNEED = 3,
        MADV_DONTNEED = 4,
        MADV_SPACEAVAIL = 5,
        MADV_VPS_PURGE = 6,
        MADV_VPS_INHERIT = 7,
        MADV_REMOVE = 9,
        MADV_DONTFORK = 10,
        MADV_DOFORK = 11,
        MADV_MERGEABLE = 65,
        MADV_UNMERGEABLE = 66,
        MADV_HUGEPAGE = 67,
        MADV_NOHUGEPAGE = 68,
        MADV_DONTDUMP = 69,
    }

    deprecated("MADV_*_PAGES are gone and never had any effect") enum
    {
        MADV_4K_PAGES = 12,
        MADV_16K_PAGES = 14,
        MADV_64K_PAGES = 16,
        MADV_256K_PAGES = 18,
        MADV_1M_PAGES = 20,
        MADV_4M_PAGES = 22,
        MADV_16M_PAGES = 24,
        MADV_64M_PAGES = 26,
    }

    // in core.sys.posix.sys.mman
    // static if (__USE_XOPEN2K) enum
    // {
    //     POSIX_MADV_NORMAL = 0,
    //     POSIX_MADV_RANDOM = 1,
    //     POSIX_MADV_SEQUENTIAL = 2,
    //     POSIX_MADV_WILLNEED = 3,
    //     POSIX_MADV_DONTNEED = 4,
    // }
}
// http://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=sysdeps/unix/sysv/linux/ia64/bits/mman.h
else version (IA64)
{
    static if (__USE_MISC) enum
    {
        MAP_GROWSDOWN = 0x00100,
        MAP_GROWSUP = 0x00200,
        MAP_DENYWRITE = 0x00800,
        MAP_EXECUTABLE = 0x01000,
        MAP_LOCKED = 0x02000,
        MAP_NORESERVE = 0x04000,
        MAP_POPULATE = 0x08000,
        MAP_NONBLOCK = 0x10000,
        MAP_STACK = 0x20000,
        MAP_HUGETLB = 0x40000,
    }
}
// http://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=sysdeps/unix/sysv/linux/m68k/bits/mman.h
else version (M68K)
{
    static if (__USE_MISC) enum
    {
        MAP_GROWSDOWN = 0x00100,
        MAP_DENYWRITE = 0x00800,
        MAP_EXECUTABLE = 0x01000,
        MAP_LOCKED = 0x02000,
        MAP_NORESERVE = 0x04000,
        MAP_POPULATE = 0x08000,
        MAP_NONBLOCK = 0x10000,
        MAP_STACK = 0x20000,
        MAP_HUGETLB = 0x40000,
    }
}
// http://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=sysdeps/unix/sysv/linux/mips/bits/mman.h
else version (MIPS_Any)
{
    static if (__USE_MISC) enum
    {
        MAP_NORESERVE = 0x0400,
        MAP_GROWSDOWN = 0x1000,
        MAP_DENYWRITE = 0x2000,
        MAP_EXECUTABLE = 0x4000,
        MAP_LOCKED = 0x8000,
        MAP_POPULATE = 0x10000,
        MAP_NONBLOCK = 0x20000,
        MAP_STACK = 0x40000,
        MAP_HUGETLB = 0x80000,
    }
}
else
{
    static assert(0, "unimplemented");
}


// <bits/mman-linux.h>
// https://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=bits/mman-linux.h
version (Alpha)
{
}
else version (HPPA_Any)
{
}
else
{
    // in core.sys.posix.sys.mman
    // enum PROT_READ = 0x1;
    // enum PROT_WRITE = 0x2;
    // enum PROT_EXEC = 0x4;
    // enum PROT_NONE = 0x0;

    enum PROT_GROWSDOWN = 0x01000000;
    enum PROT_GROWSUP = 0x02000000;

    enum MAP_SHARED = 0x01;
    enum MAP_PRIVATE = 0x02;
    static if (__USE_MISC)
        enum MAP_TYPE = 0x0f;

    enum MAP_FIXED = 0x10;
    static if (__USE_MISC) enum
    {
        MAP_FILE = 0,
        MAP_ANONYMOUS = MAP_ANON,
        // in core.sys.posix.sys.mman
        // MAP_ANON = 0xXX,
        MAP_HUGE_SHIFT = 26,
        MAP_HUGE_MASK = 0x3f,
    }

    // in core.sys.posix.sys.mman
    // enum
    // {
    //     MS_ASYNC = 1,
    //     MS_SYNC = 4,
    //     MS_INVALIDATE = 2,
    // }

    static if (__USE_GNU) enum
    {
        MREMAP_MAYMOVE = 1,
        MREMAP_FIXED = 2,
    }

    static if (__USE_MISC) enum
    {
        MADV_NORMAL = 0,
        MADV_RANDOM = 1,
        MADV_SEQUENTIAL = 2,
        MADV_WILLNEED = 3,
        MADV_DONTNEED = 4,
        MADV_REMOVE = 9,
        MADV_DONTFORK = 10,
        MADV_DOFORK = 11,
        MADV_MERGEABLE = 12,
        MADV_UNMERGEABLE = 13,
        MADV_HUGEPAGE = 14,
        MADV_NOHUGEPAGE = 15,
        MADV_DONTDUMP = 16,
        MADV_DODUMP = 17,
        MADV_HWPOISON = 100,
    }

    // in core.sys.posix.sys.mman
    // static if (__USE_XOPEN2K) enum
    // {
    //     POSIX_MADV_NORMAL = 0,
    //     POSIX_MADV_RANDOM = 1,
    //     POSIX_MADV_SEQUENTIAL = 2,
    //     POSIX_MADV_WILLNEED = 3,
    //     POSIX_MADV_DONTNEED = 4,
    // }

    // in core.sys.posix.sys.mman
    // enum
    // {
    //
    //     MCL_CURRENT = 1,
    //     MCL_FUTURE = 2,
    // }
}

// Workaround https://issues.dlang.org/show_bug.cgi?id=17883
// http://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=sysdeps/unix/sysv/linux/sparc/bits/mman.h
version (SPARC_Any)
{
    static if (__USE_MISC) enum MAP_RENAME = MAP_ANONYMOUS;
}
// http://sourceware.org/git/?p=glibc.git;a=blob;hb=51e945a8f950a6695754b11c1e6fba8bb750e100;f=sysdeps/unix/sysv/linux/mips/bits/mman.h
else version (MIPS_Any)
{
    static if (__USE_MISC) enum MAP_RENAME = MAP_ANONYMOUS;
}

// http://sourceware.org/git/?p=glibc.git;a=blob;f=misc/sys/mman.h
// in core.sys.posix.sys.mman
// static if (__USE_LARGEFILE64) void* mmap64(void*, size_t, int, int, int, off_t);
// static if (__USE_FILE_OFFSET64)
//     alias mmap64 mmap;
// else
//     void* mmap(void*, size_t, int, int, int, off_t);
// int munmap(void*, size_t);
// int mprotect(void *__addr, size_t __len, int __prot);
// int msync(void *__addr, size_t __len, int __flags);
static if (__USE_MISC) int madvise(void *__addr, size_t __len, int __advice);
// static if (__USE_XOPEN2K) int posix_madvise(void *__addr, size_t __len, int __advice);
// int mlock(const(void) *__addr, size_t __len);
// int munlock(const(void) *__addr, size_t __len);
// int mlockall(int __flags);
// int munlockall();
static if (__USE_MISC) int mincore(void *__start, size_t __len, ubyte *__vec);
static if (__USE_GNU) void *mremap(void *__addr, size_t __old_len, size_t __new_len, int __flags, ...);
static if (__USE_GNU) int remap_file_pages(void *__start, size_t __size, int __prot, size_t __pgoff, int __flags);
// int shm_open(in char *__name, int __oflag, mode_t __mode);
// int shm_unlink(in char *__name);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               .      ..    ètcp.d                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           /**
 * D header file for GNU/Linux
 *
 * Authors: Martin Nowak
 */
deprecated("Import core.sys.linux.netinet.tcp instead")
module core.sys.linux.sys.netinet.tcp;

public import core.sys.linux.netinet.tcp;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /**
 * D header file for GNU/Linux.
 *
 * License:   $(LINK2 http://www.boost.org/LICENSE_1_0.txt, Boost License 1.0)
 * Authors:   Arun Chandrasekaran <aruncxy@gmail.com>
 */
module core.sys.linux.sys.prctl;

version (linux):
extern (C):
@system:
@nogc:
nothrow:

enum: uint
{
    PR_SET_PDEATHSIG                    = 1,
    PR_GET_PDEATHSIG                    = 2,

    PR_GET_DUMPABLE                     = 3,
    PR_SET_DUMPABLE                     = 4,

    PR_GET_UNALIGN                      = 5,
    PR_SET_UNALIGN                      = 6,

    PR_UNALIGN_NOPRINT                  = 1,
    PR_UNALIGN_SIGBUS                   = 2,

    PR_GET_KEEPCAPS                     = 7,
    PR_SET_KEEPCAPS                     = 8,

    PR_GET_FPEMU                        = 9,
    PR_SET_FPEMU                        = 10,
    PR_FPEMU_NOPRINT                    = 1,
    PR_FPEMU_SIGFPE                     = 2,

    PR_GET_FPEXC                        = 11,
    PR_SET_FPEXC                        = 12,
    PR_FP_EXC_SW_ENABLE                 = 0x80,
    PR_FP_EXC_DIV                       = 0x010000,
    PR_FP_EXC_OVF                       = 0x020000,
    PR_FP_EXC_UND                       = 0x040000,
    PR_FP_EXC_RES                       = 0x080000,
    PR_FP_EXC_INV                       = 0x100000,
    PR_FP_EXC_DISABLED                  = 0,
    PR_FP_EXC_NONRECOV                  = 1,
    PR_FP_EXC_ASYNC                     = 2,
    PR_FP_EXC_PRECISE                   = 3,

    PR_GET_TIMING                       = 13,
    PR_SET_TIMING                       = 14,
    PR_TIMING_STATISTICAL               = 0,
    PR_TIMING_TIMESTAMP                 = 1,

    PR_SET_NAME                         = 15,
    PR_GET_NAME                         = 16,

    PR_GET_ENDIAN                       = 19,
    PR_SET_ENDIAN                       = 20,
    PR_ENDIAN_BIG                       = 0,
    PR_ENDIAN_LITTLE                    = 1,
    PR_ENDIAN_PPC_LITTLE                = 2,

    PR_GET_SECCOMP                      = 21,
    PR_SET_SECCOMP                      = 22,

    PR_CAPBSET_READ                     = 23,
    PR_CAPBSET_DROP                     = 24,

    PR_GET_TSC                          = 25,
    PR_SET_TSC                          = 26,
    PR_TSC_ENABLE                       = 1,
    PR_TSC_SIGSEGV                      = 2,

    PR_GET_SECUREBITS                   = 27,
    PR_SET_SECUREBITS                   = 28,


    PR_SET_TIMERSLACK                   = 29,
    PR_GET_TIMERSLACK                   = 30,

    PR_TASK_PERF_EVENTS_DISABLE         = 31,
    PR_TASK_PERF_EVENTS_ENABLE          = 32,


    PR_MCE_KILL                         = 33,
    PR_MCE_KILL_CLEAR                   = 0,
    PR_MCE_KILL_SET                     = 1,

    PR_MCE_KILL_LATE                    = 0,
    PR_MCE_KILL_EARLY                   = 1,
    PR_MCE_KILL_DEFAULT                 = 2,

    PR_MCE_KILL_GET                     = 34,

    PR_SET_MM                           = 35,
    PR_SET_MM_START_CODE                = 1,
    PR_SET_MM_END_CODE                  = 2,
    PR_SET_MM_START_DATA                = 3,
    PR_SET_MM_END_DATA                  = 4,
    PR_SET_MM_START_STACK               = 5,
    PR_SET_MM_START_BRK                 = 6,
    PR_SET_MM_BRK                       = 7,
    PR_SET_MM_ARG_START                 = 8,
    PR_SET_MM_ARG_END                   = 9,
    PR_SET_MM_ENV_START                 = 10,
    PR_SET_MM_ENV_END                   = 11,
    PR_SET_MM_AUXV                      = 12,
    PR_SET_MM_EXE_FILE                  = 13,
    PR_SET_MM_MAP                       = 14,
    PR_SET_MM_MAP_SIZE                  = 15,

    PR_SET_PTRACER                      = 0x59616d61,
    PR_SET_PTRACER_ANY                  = (cast (uint)-1),

    PR_SET_CHILD_SUBREAPER              = 36,
    PR_GET_CHILD_SUBREAPER              = 37,

    PR_SET_NO_NEW_PRIVS                 = 38,
    PR_GET_NO_NEW_PRIVS                 = 39,

    PR_GET_TID_ADDRESS                  = 40,

    PR_SET_THP_DISABLE                  = 41,
    PR_GET_THP_DISABLE                  = 42,
}

struct prctl_mm_map
{
    ulong    start_code;
    ulong    end_code;
    ulong    start_data;
    ulong    end_data;
    ulong    start_brk;
    ulong    brk;
    ulong    start_stack;
    ulong    arg_start;
    ulong    arg_end;
    ulong    env_start;
    ulong    env_end;
    ulong*   auxv;
    uint     auxv_size;
    uint     exe_fd;
};

int prctl(int option, size_t arg2, size_t arg3, size_t arg4, size_t arg5);

//
// Example usage to set and get the task name.
//
// byte[16] oldname = cast(byte[]) "1234567890123456";
// oldname[oldname.length-1] = 0;
// prctl(PR_SET_NAME, cast(size_t) oldname.ptr, cast(size_t) null, cast(size_t) null, cast(size_t) null);
// byte[16] newname;
// prctl(PR_GET_NAME, cast(size_t) newname.ptr, cast(size_t) null, cast(size_t) null, cast(size_t) null);
// int i;
// foreach (b; newname)
// {
//         assert(b == oldname[i]);
//             i++;
// }
// writeln(cast(string) newname);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /**
 * D header file for Linux.
 *
 * Copyright: Copyright Alex RÃ¸nne Petersen 2012.
 * License:   $(LINK2 http://www.boost.org/LICENSE_1_0.txt, Boost License 1.0)
 * Authors:   Alex RÃ¸nne Petersen
 */
module core.sys.linux.sys.signalfd;

import core.sys.posix.signal;

version (linux):

extern (C):
@system:
nothrow:

struct signalfd_siginfo
{
    uint ssi_signo;
    int ssi_errno;
    int ssi_code;
    uint ssi_pid;
    uint ssi_uid;
    int ssi_fd;
    uint ssi_tid;
    uint ssi_band;
    uint ssi_overrun;
    uint ssi_trapno;
    int ssi_status;
    int ssi_int;
    ulong ssi_ptr;
    ulong ssi_utime;
    ulong ssi_stime;
    ulong ssi_addr;
    ubyte[48] __pad;
}

enum SFD_CLOEXEC = 0x80000; // 02000000
enum SFD_NONBLOCK = 0x800; // 04000

int signalfd (int __fd, const(sigset_t)* __mask, int __flags);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              /**
 * D header file for GNU/Linux.
 *
 * License:   $(LINK2 http://www.boost.org/LICENSE_1_0.txt, Boost License 1.0)
 * Authors:   Paul O'Neil
 */
module core.sys.linux.sys.socket;

public import core.sys.posix.sys.socket;

version (linux):
extern(C):
@nogc:
nothrow:

enum
{
    // Protocol families.
    PF_UNSPEC     = 0,
    PF_LOCAL      = 1,
    PF_UNIX       = PF_LOCAL,
    PF_FILE       = PF_LOCAL,
    PF_INET       = 2,
    PF_AX25       = 3,
    PF_NETROM     = 6,
    PF_BRIDGE     = 7,
    PF_ATMPVC     = 8,
    PF_X25        = 9,
    PF_INET6      = 10,
    PF_ROSE       = 11,
    PF_DECnet     = 12,
    PF_NETBEUI    = 13,
    PF_SECURITY   = 14,
    PF_KEY        = 15,
    PF_NETLINK    = 16,
    PF_ROUTE      = PF_NETLINK,
    PF_PACKET     = 17,
    PF_ASH        = 18,
    PF_ECONET     = 19,
    PF_ATMSVC     = 20,
    PF_RDS        = 21,
    PF_SNA        = 22,
    PF_IRDA       = 23,
    PF_PPPOX      = 24,
    PF_WANPIPE    = 25,
    PF_LLC        = 26,
    PF_IB         = 27,
    PF_MPLS       = 28,
    PF_CAN        = 29,
    PF_TIPC       = 30,
    PF_BLUETOOTH  = 31,
    PF_IUCV       = 32,
    PF_RXRPC      = 33,
    PF_ISDN       = 34,
    PF_PHONET     = 35,
    PF_IEEE802154 = 36,
    PF_CAIF       = 37,
    PF_ALG        = 38,
    PF_NFC        = 39,
    PF_VSOCK      = 40,
    PF_KCM        = 41,
    PF_QIPCRTR    = 42,
    PF_SMC        = 43,
    PF_MAX        = 44,

    // Address families.
    AF_LOCAL      = PF_LOCAL,
    AF_FILE       = AF_LOCAL,
    AF_AX25       = PF_AX25,
    AF_NETROM     = PF_NETROM,
    AF_BRIDGE     = PF_BRIDGE,
    AF_ATMPVC     = PF_ATMPVC,
    AF_X25        = PF_X25,
    AF_INET6      = PF_INET6,
    AF_ROSE       = PF_ROSE,
    AF_DECnet     = PF_DECnet,
    AF_NETBEUI    = PF_NETBEUI,
    AF_SECURITY   = PF_SECURITY,
    AF_KEY        = PF_KEY,
    AF_NETLINK    = PF_NETLINK,
    AF_ROUTE      = PF_ROUTE,
    AF_PACKET     = PF_PACKET,
    AF_ASH        = PF_ASH,
    AF_ECONET     = PF_ECONET,
    AF_ATMSVC     = PF_ATMSVC,
    AF_RDS        = PF_RDS,
    AF_SNA        = PF_SNA,
    AF_IRDA       = PF_IRDA,
    AF_PPPOX      = PF_PPPOX,
    AF_WANPIPE    = PF_WANPIPE,
    AF_LLC        = PF_LLC,
    AF_IB         = PF_IB,
    AF_MPLS       = PF_MPLS,
    AF_CAN        = PF_CAN,
    AF_TIPC       = PF_TIPC,
    AF_BLUETOOTH  = PF_BLUETOOTH,
    AF_IUCV       = PF_IUCV,
    AF_RXRPC      = PF_RXRPC,
    AF_ISDN       = PF_ISDN,
    AF_PHONET     = PF_PHONET,
    AF_IEEE802154 = PF_IEEE802154,
    AF_CAIF       = PF_CAIF,
    AF_ALG        = PF_ALG,
    AF_NFC        = PF_NFC,
    AF_VSOCK      = PF_VSOCK,
    AF_KCM        = PF_KCM,
    AF_QIPCRTR    = PF_QIPCRTR,
    AF_SMC        = PF_SMC,
    AF_MAX        = PF_MAX,
}

// For getsockopt() and setsockopt()
enum
{
    SO_SECURITY_AUTHENTICATION       = 22,
    SO_SECURITY_ENCRYPTION_TRANSPORT = 23,
    SO_SECURITY_ENCRYPTION_NETWORK   = 24,

    SO_BINDTODEVICE            = 25,

    SO_ATTACH_FILTER           = 26,
    SO_DETACH_FILTER           = 27,
    SO_GET_FILTER              = SO_ATTACH_FILTER,

    SO_PEERNAME                = 28,
    SO_TIMESTAMP               = 29,
    SCM_TIMESTAMP              = SO_TIMESTAMP,

    SO_PASSSEC                 = 34,
    SO_TIMESTAMPNS             = 35,
    SCM_TIMESTAMPNS            = SO_TIMESTAMPNS,
    SO_MARK                    = 36,
    SO_TIMESTAMPING            = 37,
    SCM_TIMESTAMPING           = SO_TIMESTAMPING,
    SO_RXQ_OVFL                = 40,
    SO_WIFI_STATUS             = 41,
    SCM_WIFI_STATUS            = SO_WIFI_STATUS,
    SO_PEEK_OFF                = 42,
    SO_NOFCS                   = 43,
    SO_LOCK_FILTER             = 44,
    SO_SELECT_ERR_QUEUE        = 45,
    SO_BUSY_POLL               = 46,
    SO_MAX_PACING_RATE         = 47,
    SO_BPF_EXTENSIONS          = 48,
    SO_INCOMING_CPU            = 49,
    SO_ATTACH_BPF              = 50,
    SO_DETACH_BPF              = SO_DETACH_FILTER,
    SO_ATTACH_REUSEPORT_CBPF   = 51,
    SO_ATTACH_REUSEPORT_EBPF   = 52,
    SO_CNX_ADVICE              = 53,
    SCM_TIMESTAMPING_OPT_STATS = 54,
    SO_MEMINFO                 = 55,
    SO_INCOMING_NAPI_ID        = 56,
    SO_COOKIE                  = 57,
    SCM_TIMESTAMPING_PKTINFO   = 58,
    SO_PEERGROUPS              = 59,
    SO_ZEROCOPY                = 60,
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /**
 * D header file for GNU/Linux.
 *
 * License:   $(LINK2 http://www.boost.org/LICENSE_1_0.txt, Boost License 1.0)
 * Authors:   Martin Nowak
 */
module core.sys.linux.sys.sysinfo;

version (linux) extern(C) @nogc nothrow:

import core.sys.linux.config;

// linux/sysinfo.h
enum SI_LOAD_SHIFT = 16;

struct sysinfo_
{
    c_long uptime;     /* Seconds since boot */
    c_ulong[3] loads;  /* 1, 5, and 15 minute load averages */
    c_ulong totalram;  /* Total usable main memory size */
    c_ulong freeram;   /* Available memory size */
    c_ulong sharedram; /* Amount of shared memory */
    c_ulong bufferram; /* Memory used by buffers */
    c_ulong totalswap; /* Total swap space size */
    c_ulong freeswap;  /* swap space still available */
    ushort procs;      /* Number of current processes */
    ushort pad;        /* Explicit padding for m68k */
    c_ulong totalhigh; /* Total high memory size */
    c_ulong freehigh;  /* Available high memory size */
    uint mem_unit;     /* Memory unit size in bytes */
    ubyte[20-2 * c_ulong.sizeof - uint.sizeof] _f; /* Padding: libc5 uses this.. */
}


int sysinfo(sysinfo_ *info);
int get_nprocs_conf();
int get_nprocs();
c_long get_phys_pages();
c_long get_avphys_pages();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /**
 * D header file for POSIX.
 *
 * Copyright: Copyright Sociomantic Labs GmbH.
 * License:   $(HTTP www.boost.org/LICENSE_1_0.txt, Boost License 1.0).
 * Authors:   Leandro Lucarella
 */

/*          Copyright Sociomantic Labs GmbH.
 * Distributed under the Boost Software License, Version 1.0.
 *    (See accompanying file LICENSE or copy at
 *          http://www.boost.org/LICENSE_1_0.txt)
 */
module core.sys.linux.sys.time;

private import core.sys.linux.config;
public import core.sys.posix.sys.time;  // timeval

version (linux):

/* macros provided to operate on timeval structures
 * they are extern(D) because they are not really C symbols, just macros
 */
extern (D) pure @safe @nogc nothrow {

    void timeradd(const timeval* a, const timeval* b,
            timeval* result)
    {
        result.tv_sec = a.tv_sec + b.tv_sec;
        result.tv_usec = a.tv_usec + b.tv_usec;
        if (result.tv_usec >= 1_000_000)
        {
            ++result.tv_sec;
            result.tv_usec -= 1_000_000;
        }
    }

    void timersub(const timeval* a, const timeval* b,
            timeval *result)
    {
        result.tv_sec = a.tv_sec - b.tv_sec;
        result.tv_usec = a.tv_usec - b.tv_usec;
        if (result.tv_usec < 0) {
            --result.tv_sec;
            result.tv_usec += 1_000_000;
        }
    }

    void timerclear(timeval* tvp)
    {
        (tvp.tv_sec = tvp.tv_usec = 0);
    }

    int timerisset(timeval* tvp)
    {
        return cast(int) (tvp.tv_sec || tvp.tv_usec);
    }

    int timercmp(string CMP)(const timeval* a, const timeval* b)
    {
        return cast(int)
               mixin("((a.tv_sec == b.tv_sec) ?" ~
                     "(a.tv_usec" ~ CMP ~ "b.tv_usec) :" ~
                     "(a.tv_sec"  ~ CMP ~ "b.tv_sec))");
    }

}

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                /**
 * D header file for GNU/Linux.
 *
 * Copyright: Copyright Robert Klotzner 2012.
 * License:   $(LINK2 http://www.boost.org/LICENSE_1_0.txt, Boost License 1.0)
 * Authors:   Robert Klotzner
 */
module core.sys.linux.sys.xattr;

import core.sys.posix.sys.types;

version (linux):
extern (C):
@system:
nothrow:

enum {
    XATTR_CREATE = 1, /* set value, fail if attr already exists.  */
    XATTR_REPLACE = 2 /* set value, fail if attr does not exist.  */
}

enum XATTR_OS2_PREFIX = "os2.";
enum XATTR_OS2_PREFIX_LEN = XATTR_OS2_PREFIX.length;
enum XATTR_SECURITY_PREFIX = "security.";
enum XATTR_SECURITY_PREFIX_LEN = XATTR_SECURITY_PREFIX.length;
enum XATTR_SYSTEM_PREFIX = "system.";
enum XATTR_SYSTEM_PREFIX_LEN = XATTR_SYSTEM_PREFIX.length;
enum XATTR_TRUSTED_PREFIX = "trusted.";
enum XATTR_TRUSTED_PREFIX_LEN = XATTR_TRUSTED_PREFIX.length;
enum XATTR_USER_PREFIX = "user.";
enum XATTR_USER_PREFIX_LEN = XATTR_USER_PREFIX.length;

/* Security namespace */
enum XATTR_SELINUX_SUFFIX = "selinux.";
enum XATTR_NAME_SELINUX = XATTR_SECURITY_PREFIX ~ XATTR_SELINUX_SUFFIX;

enum XATTR_SMACK_SUFFIX = "SMACK64";
enum XATTR_SMACK_IPIN = "SMACK64IPIN";
enum XATTR_SMACK_IPOUT = "SMACK64IPOUT";
enum XATTR_SMACK_EXEC = "SMACK64EXEC";
enum XATTR_SMACK_TRANSMUTE = "SMACK64TRANSMUTE";
enum XATTR_SMACK_MMAP = "SMACK64MMAP";

enum XATTR_NAME_SMACK = XATTR_SECURITY_PREFIX ~ XATTR_SMACK_SUFFIX;
enum XATTR_NAME_SMACKIPIN = XATTR_SECURITY_PREFIX ~ XATTR_SMACK_IPIN;
enum XATTR_NAME_SMACKIPOUT = XATTR_SECURITY_PREFIX ~ XATTR_SMACK_IPOUT;
enum XATTR_NAME_SMACKEXEC = XATTR_SECURITY_PREFIX ~ XATTR_SMACK_EXEC;
enum XATTR_NAME_SMACKTRANSMUTE = XATTR_SECURITY_PREFIX ~ XATTR_SMACK_TRANSMUTE;
enum XATTR_NAME_SMACKMMAP = XATTR_SECURITY_PREFIX ~ XATTR_SMACK_MMAP;

enum XATTR_CAPS_SUFFIX = "capability";
enum XATTR_NAME_CAPS = XATTR_SECURITY_PREFIX ~ XATTR_CAPS_SUFFIX;


int setxattr(in char* path, in char* name, in void* value, size_t size, int flags);

int lsetxattr(in char* path, in char* name, in void* value, size_t size, int flags);
int fsetxattr(int fd, in char* name, in void* value, size_t size, int flags);
ssize_t getxattr(in char* path, in char* name, void* value, size_t size);
ssize_t lgetxattr(in char* path, in char* name, void* value, size_t size);
ssize_t fgetxattr(int fd, in char* name, void* value, size_t size);
ssize_t listxattr(in char* path, char* list, size_t size);
ssize_t llistxattr(in char* path, char* list, size_t size);
ssize_t flistxattr (int __fd, char *list, size_t size);
int removexattr (in char *path, in char *name);
int lremovexattr (in char *path, in char *name);
int fremovexattr (int fd, in char *name);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /**
 * D header file for GNU/Linux
 */
/* Distributed under the Boost Software License, Version 1.0.
 *    (See accompanying file LICENSE or copy at
 *          http://www.boost.org/LICENSE_1_0.txt)
 */

module core.sys.linux.termios;

version (linux):
    public import core.sys.posix.termios;

    enum B57600 = 0x1001; // 0010001
    enum B115200 = 0x1002; // 0010002
    enum B230400 = 0x1003; // 0010003
    enum B460800 = 0x1004; // 0010004
    enum B500000 = 0x1005; // 0010005
    enum B576000 = 0x1006; // 0010006
    enum B921600 = 0x1007; // 0010007
    enum B1000000 = 0x1008; // 0010010
    enum B1152000 = 0x1009; // 0010011
    enum B1500000 = 0x100A; // 0010012
    enum B2000000 = 0x100B; // 0010013
    enum B2500000 = 0x100C; // 0010014
    enum B3000000 = 0x100D; // 0010015
    enum B3500000 = 0x100E; // 0010016
    enum B4000000 = 0x100F; // 0010017

    enum CRTSCTS = 0x80000000; // 020000000000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       //Written in the D programming language

/++
    D header file for Linux extensions to POSIX's time.h.

    Copyright: Copyright 2014
    License:   $(HTTP www.boost.org/LICENSE_1_0.txt, Boost License 1.0).
    Authors:   $(HTTP jmdavisprog.com, Jonathan M Davis)
 +/
module core.sys.linux.time;

public import core.sys.posix.time;

version (linux):

enum CLOCK_MONOTONIC_RAW      = 4;
enum CLOCK_REALTIME_COARSE    = 5;
enum CLOCK_MONOTONIC_COARSE   = 6;
enum CLOCK_BOOTTIME           = 7;
enum CLOCK_REALTIME_ALARM     = 8;
enum CLOCK_BOOTTIME_ALARM     = 9;
enum CLOCK_SGI_CYCLE          = 10;
enum CLOCK_TAI                = 11;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /**
 * D header file to interface with the Linux timefd API <http://man7.org/linux/man-pages/man2/timerfd_create.2.html>
 * Available since Linux 2.6
 *
 * License : $(LINK2 http://www.boost.org/LICENSE_1_0.txt, Boost License 1.0)
 */
module core.sys.linux.timerfd;

version (linux):

public import core.sys.posix.time;

extern (C):
@system:
@nogc:
nothrow:

int timerfd_create(int clockid, int flags);
int timerfd_settime(int fd, int flags, const itimerspec* new_value, itimerspec* old_value);
int timerfd_gettime(int fd, itimerspec* curr_value);

enum TFD_TIMER_ABSTIME = 1 << 0;
enum TFD_CLOEXEC       = 0x80000;
enum TFD_NONBLOCK      = 0x800;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /**
 * Interface for Linux TIPC sockets, /usr/include/linux/tipc.h
 *
 * Copyright: Public Domain
 * License:   Public Domain
 * Authors:   Leandro Lucarella
 */

module core.sys.linux.tipc;

version (linux):
extern (C) nothrow @nogc:

struct tipc_portid
{
        uint ref_;
        uint node;
}

struct tipc_name
{
        uint type;
        uint instance;
}

struct tipc_name_seq
{
        uint type;
        uint lower;
        uint upper;
}

struct tipc_subscr
{
        tipc_name_seq seq;
        uint timeout;
        uint filter;
        ubyte[8] usr_handle;
}

struct tipc_event
{
        uint event;
        uint found_lower;
        uint found_upper;
        tipc_portid port;
        tipc_subscr s;
}

struct sockaddr_tipc
{
        ushort family;
        ubyte addrtype;
        byte scope_;
        union Addr
        {
                tipc_portid id;
                tipc_name_seq nameseq;
                static struct Name
                {
                        tipc_name name;
                        uint domain;
                }
                Name name;
        }
        Addr addr;
}

uint tipc_addr(uint zone, uint cluster, uint node)
{
        return (zone << 24) | (cluster << 12) | node;
}

unittest
{
        assert (tipc_addr(0, 0, 0) == 0);
        assert (tipc_addr(1, 1, 1) == 16781313);
        assert (tipc_addr(2, 1, 27) == 33558555);
        assert (tipc_addr(3, 1, 63) == 50335807);
}

uint tipc_zone(uint addr)
{
        return addr >> 24;
}

unittest
{
        assert (tipc_zone(0u) == 0);
        assert (tipc_zone(16781313u) == 1);
        assert (tipc_zone(33558555u) == 2);
        assert (tipc_zone(50335807u) == 3);
}

uint tipc_cluster(uint addr)
{
        return (addr >> 12) & 0xfff;
}

unittest
{
        assert (tipc_cluster(0u) == 0);
        assert (tipc_cluster(16781313u) == 1);
        assert (tipc_cluster(33558555u) == 1);
        assert (tipc_cluster(50335807u) == 1);
}

uint tipc_node(uint addr)
{
        return addr & 0xfff;
}

unittest
{
        assert (tipc_node(0u) == 0);
        assert (tipc_node(16781313u) == 1);
        assert (tipc_node(33558555u) == 27);
        assert (tipc_node(50335807u) == 63);
}

enum: int
{
        TIPC_CFG_SRV    = 0,
        TIPC_TOP_SRV    = 1,
        TIPC_RESERVED_TYPES = 64,
}

enum: int
{
        TIPC_ZONE_SCOPE    = 1,
        TIPC_CLUSTER_SCOPE = 2,
        TIPC_NODE_SCOPE    = 3,
}

enum: int
{
        TIPC_MAX_USER_MSG_SIZE = 66000,
}

enum: int
{
        TIPC_LOW_IMPORTANCE      = 0,
        TIPC_MEDIUM_IMPORTANCE   = 1,
        TIPC_HIGH_IMPORTANCE     = 2,
        TIPC_CRITICAL_IMPORTANCE = 3,
}

enum: int
{
        TIPC_OK     = 0,
        TIPC_ERR_NO_NAME   = 1,
        TIPC_ERR_NO_PORT   = 2,
        TIPC_ERR_NO_NODE   = 3,
        TIPC_ERR_OVERLOAD  = 4,
        TIPC_CONN_SHUTDOWN = 5,
}

enum: int
{
        TIPC_SUB_PORTS    = 0x01,
        TIPC_SUB_SERVICE  = 0x02,
        TIPC_SUB_CANCEL   = 0x04,
}

version (none) enum: int
{
        TIPC_SUB_NO_BIND_EVTS   = 0x04,
        TIPC_SUB_NO_UNBIND_EVTS = 0x08,
        TIPC_SUB_SINGLE_EVT     = 0x10,
}

enum: int
{
        TIPC_WAIT_FOREVER = ~0,
}

enum: int
{

        TIPC_PUBLISHED      = 1,
        TIPC_WITHDRAWN      = 2,
        TIPC_SUBSCR_TIMEOUT = 3,
}

enum: int
{
        AF_TIPC    = 30,
        PF_TIPC    = 30,
        SOL_TIPC          = 271,
        TIPC_ADDR_NAMESEQ = 1,
        TIPC_ADDR_MCAST   = 1,
        TIPC_ADDR_NAME    = 2,
        TIPC_ADDR_ID      = 3,
}

enum: int
{
        TIPC_ERRINFO  = 1,
        TIPC_RETDATA  = 2,
        TIPC_DESTNAME = 3,
}

enum: int
{
        TIPC_IMPORTANCE     = 127,
        TIPC_SRC_DROPPABLE  = 128,
        TIPC_DEST_DROPPABLE = 129,
        TIPC_CONN_TIMEOUT   = 130,
}

                                                                                                                                                                                                                                                                                                                                                                                       module core.sys.linux.unistd;

public import core.sys.posix.unistd;

version (linux):
extern(C):
nothrow:

// Additional seek constants for sparse file handling
// from Linux's unistd.h, stdio.h, and linux/fs.h
// (see http://man7.org/linux/man-pages/man2/lseek.2.html)
enum {
    /// Offset is relative to the next location containing data
    SEEK_DATA = 3,
    /// Offset is relative to the next hole (or EOF if file is not sparse)
    SEEK_HOLE = 4
}

/// Prompt for a password without echoing it.
char* getpass(const(char)* prompt);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      &   .   Ç   ..  '   dlfcn.d (   
execinfo.d  )   sys 1  ¸time.d                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          /**
 * D header file for NetBSD.
 *
 * Copyright: Copyright Martin Nowak 2012.
 * License:   $(HTTP www.boost.org/LICENSE_1_0.txt, Boost License 1.0).
 * Authors:   Martin Nowak
 *
 * http://cvsweb.netbsd.org/bsdweb.cgi/~checkout~/src/include/dlfcn.h
 */
module core.sys.netbsd.dlfcn;

public import core.sys.posix.dlfcn;

version (NetBSD):
extern (C):
nothrow:
@nogc:

enum __BSD_VISIBLE = true;

/*
 * Modes and flags for dlopen().
 */
static assert(RTLD_LAZY   == 1);
static assert(RTLD_NOW    == 2);
static assert(RTLD_GLOBAL == 0x100);
static assert(RTLD_LOCAL  == 0x200);
//enum RTLD_TRACE           =  0x200;
enum RTLD_NODELETE        =  0x01000;
enum RTLD_NOLOAD          =  0x02000;

/*
 * Request arguments for dlinfo().
 */
enum RTLD_DI_LINKMAP     = 3;    /* Obtain link map. */
enum RTLD_DI_SERINFO     = 5;    /* Obtain search path info. */
enum RTLD_DI_SERINFOSIZE = 6;    /*  ... query for required space. */
enum RTLD_DI_ORIGIN      = 7;    /* Obtain object origin */
enum RTLD_DI_MAX         = RTLD_DI_ORIGIN;

/*
 * Special handle arguments for dlsym()/dlinfo().
 */
enum RTLD_NEXT    = cast(void *)-1;    /* Search subsequent objects. */
enum RTLD_DEFAULT = cast(void *)-2;    /* Use default search algorithm. */
enum RTLD_SELF    = cast(void *)-3;    /* Search the caller itself. */

static if (__BSD_VISIBLE)
{
    /*
     * Structure filled in by dladdr().
     */
    struct Dl_info {
        const(char)     *dli_fname;     /* Pathname of shared object. */
        void            *dli_fbase;     /* Base address of shared object. */
        const(char)     *dli_sname;     /* Name of nearest symbol. */
        void            *dli_saddr;     /* Address of nearest symbol. */
    };

    /*-
     * The actual type declared by this typedef is immaterial, provided that
     * it is a function pointer.  Its purpose is to provide a return type for
     * dlfunc() which can be cast to a function pointer type without depending
     * on behavior undefined by the C standard, which might trigger a compiler
     * diagnostic.  We intentionally declare a unique type signature to force
     * a diagnostic should the application not cast the return value of dlfunc()
     * appropriately.
     */
    struct __dlfunc_arg {
        int     __dlfunc_dummy;
    };

    alias dlfunc_t = void function(__dlfunc_arg);

    /*
     * Structures, returned by the RTLD_DI_SERINFO dlinfo() request.
     */
    struct Dl_serpath {
        char *          dls_name;       /* single search path entry */
        uint            dls_flags;      /* path information */
    };

    struct Dl_serinfo {
        size_t          dls_size;       /* total buffer size */
        uint            dls_cnt;        /* number of path entries */
        Dl_serpath[1]   dls_serpath;    /* there may be more than one */
    };
}

private template __externC(RT, P...)
{
    alias __externC = extern(C) RT function(P) nothrow @nogc;
}

/* XSI functions first. */
static assert(is(typeof(&dlclose) == __externC!(int, void*)));
static assert(is(typeof(&dlerror) == __externC!(char*)));
static assert(is(typeof(&dlopen)  == __externC!(void*, const char*, int)));
static assert(is(typeof(&dlsym)   == __externC!(void*, void*, const char*)));

static if (__BSD_VISIBLE)
{
    //void*    fdlopen(int, int);
    int      dladdr(const(void)*, Dl_info*);
    //dlfunc_t dlfunc(void*, const(char)*);
    int      dlinfo(void*, int, void*);
    /+void     dllockinit(void* _context,
        void* function(void* _context) _lock_create,
        void  function(void* _lock)    _rlock_acquire,
        void  function(void* _lock)    _wlock_acquire,
        void  function(void* _lock)    _lock_release,
        void  function(void* _lock)    _lock_destroy,
        void  function(void* _context) _context_destroy);+/
    void*    dlvsym(void*, const(char)*, const(char)*);
}
                                                                                                                                                                                                                                                /**
 * NetBSD implementation of glibc's $(LINK2 http://www.gnu.org/software/libc/manual/html_node/Backtraces.html backtrace) facility.
 *
 * Copyright: Copyright Martin Nowak 2012.
 * License:   $(LINK2 http://www.boost.org/LICENSE_1_0.txt, Boost License 1.0)
 * Authors:   Martin Nowak
 * Source:    $(DRUNTIMESRC core/sys/netbsd/_execinfo.d)
 */
module core.sys.netbsd.execinfo;

version (NetBSD):
extern (C):
nothrow:

version (GNU)
    version = BacktraceExternal;

version (BacktraceExternal)
{
    size_t backtrace(void**, size_t);
    char** backtrace_symbols(const(void*)*, size_t);
    void backtrace_symbols_fd(const(void*)*, size_t, int);
    char** backtrace_symbols_fmt(const(void*)*, size_t, const char*);
    int backtrace_symbols_fd_fmt(const(void*)*, size_t, int, const char*);
}
else
{
    import core.sys.netbsd.dlfcn;

    // Use extern (D) so that these functions don't collide with libexecinfo.

    extern (D) int backtrace(void** buffer, int size)
    {
        import core.thread : thread_stackBottom;

        void** p, pend=cast(void**)thread_stackBottom();
        version (D_InlineAsm_X86)
            asm nothrow @trusted { mov p[EBP], EBP; }
        else version (D_InlineAsm_X86_64)
            asm nothrow @trusted { mov p[RBP], RBP; }
        else
            static assert(false, "Architecture not supported.");

        int i;
        for (; i < size && p < pend; ++i)
        {
            buffer[i] = *(p + 1);
            auto pnext = cast(void**)*p;
            if (pnext <= p) break;
            p = pnext;
        }
        return i;
    }


    extern (D) char** backtrace_symbols(const(void*)* buffer, int size)
    {
        static void* realloc(void* p, size_t len) nothrow
        {
            static import cstdlib=core.stdc.stdlib;
            auto res = cstdlib.realloc(p, len);
            if (res is null) cstdlib.free(p);
            return res;
        }

        if (size <= 0) return null;

        size_t pos = size * (char*).sizeof;
        char** p = cast(char**)realloc(null, pos);
        if (p is null) return null;

        Dl_info info;
        foreach (i, addr; buffer[0 .. size])
        {
            if (dladdr(addr, &info) == 0)
                (cast(ubyte*)&info)[0 .. info.sizeof] = 0;
            fixupDLInfo(addr, info);

            immutable len = formatStackFrame(null, 0, addr, info);
            assert(len > 0);

            p = cast(char**)realloc(p, pos + len);
            if (p is null) return null;

            formatStackFrame(cast(char*)p + pos, len, addr, info) == len || assert(0);

            p[i] = cast(char*)pos;
            pos += len;
        }
        foreach (i; 0 .. size)
        {
            pos = cast(size_t)p[i];
            p[i] = cast(char*)p + pos;
        }
        return p;
    }


    extern (D) void backtrace_symbols_fd(const(void*)* buffer, int size, int fd)
    {
        import core.sys.posix.unistd : write;
        import core.stdc.stdlib : alloca;

        if (size <= 0) return;

        Dl_info info;
        foreach (i, addr; buffer[0 .. size])
        {
            if (dladdr(addr, &info) == 0)
                (cast(ubyte*)&info)[0 .. info.sizeof] = 0;
            fixupDLInfo(addr, info);

            enum maxAlloca = 1024;
            enum min = (size_t a, size_t b) => a <= b ? a : b;
            immutable len = min(formatStackFrame(null, 0, addr, info), maxAlloca);
            assert(len > 0);

            auto p = cast(char*)alloca(len);
            if (p is null) return;

            formatStackFrame(p, len, addr, info) >= len || assert(0);
            p[len - 1] = '\n';
            write(fd, p, len);
        }
    }


    private void fixupDLInfo(const(void)* addr, ref Dl_info info)
    {
        if (info.dli_fname is null) info.dli_fname = "???";
        if (info.dli_fbase is null) info.dli_fbase = null;
        if (info.dli_sname is null) info.dli_sname = "???";
        if (info.dli_saddr is null) info.dli_saddr = cast(void*)addr;
    }


    private size_t formatStackFrame(char* p, size_t plen, const(void)* addr, const ref Dl_info info)
    {
        import core.stdc.stdio : snprintf;

        immutable off = addr - info.dli_saddr;
        immutable len = snprintf(p, plen, "%p <%s+%zd> at %s",
                                 addr, info.dli_sname, off, info.dli_fname);
        assert(len > 0);
        return cast(size_t)len + 1; // + '\0'
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          )   .   &   ..  *   elf.d   +   elf32.d ,   elf64.d -   elf_common.d.   event.d /   
link_elf.d  0  mman.d                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /**
 * D header file for NetBSD.
 *
 */
module core.sys.netbsd.sys.elf;

version (NetBSD):

public import core.sys.netbsd.sys.elf32;
public import core.sys.netbsd.sys.elf64;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /**
 * D header file for NetBSD.
 *
 * http://cvsweb.netbsd.org/bsdweb.cgi/~checkout~/src/sys/sys/exec_elf.h
 */
module core.sys.netbsd.sys.elf32;

version (NetBSD):
extern (C):
pure:
nothrow:

import core.stdc.stdint;
public import core.sys.netbsd.sys.elf_common;

alias uint16_t Elf32_Half;
alias uint32_t Elf32_Word;
alias int32_t  Elf32_Sword;
alias uint64_t Elf32_Lword;
alias uint32_t Elf32_Addr;
alias uint32_t Elf32_Off;
alias Elf32_Word Elf32_Hashelt;
alias Elf32_Word Elf32_Size;
alias Elf32_Sword Elf32_Ssize;

struct Elf32_Ehdr
{
    char[EI_NIDENT] e_ident = 0;
    Elf32_Half    e_type;
    Elf32_Half    e_machine;
    Elf32_Word    e_version;
    Elf32_Addr    e_entry;
    Elf32_Off     e_phoff;
    Elf32_Off     e_shoff;
    Elf32_Word    e_flags;
    Elf32_Half    e_ehsize;
    Elf32_Half    e_phentsize;
    Elf32_Half    e_phnum;
    Elf32_Half    e_shentsize;
    Elf32_Half    e_shnum;
    Elf32_Half    e_shstrndx;
}

struct Elf32_Shdr
{
    Elf32_Word    sh_name;
    Elf32_Word    sh_type;
    Elf32_Word    sh_flags;
    Elf32_Addr    sh_addr;
    Elf32_Off     sh_offset;
    Elf32_Word    sh_size;
    Elf32_Word    sh_link;
    Elf32_Word    sh_info;
    Elf32_Word    sh_addralign;
    Elf32_Word    sh_entsize;
}

struct Elf32_Phdr
{
    Elf32_Word    p_type;
    Elf32_Off     p_offset;
    Elf32_Addr    p_vaddr;
    Elf32_Addr    p_paddr;
    Elf32_Word    p_filesz;
    Elf32_Word    p_memsz;
    Elf32_Word    p_flags;
    Elf32_Word    p_align;
}

struct Elf32_Dyn
{
  Elf32_Sword   d_tag;
  union _d_un
  {
      Elf32_Word d_val;
      Elf32_Addr d_ptr;
  } _d_un d_un;
}

struct Elf32_Rel
{
    Elf32_Addr    r_offset;
    Elf32_Word    r_info;
}

struct Elf32_Rela
{
    Elf32_Addr    r_offset;
    Elf32_Word    r_info;
    Elf32_Sword   r_addend;
}

extern (D)
{
    auto ELF32_R_SYM(V)(V val) { return val >> 8; }
    auto ELF32_R_TYPE(V)(V val) { return val & 0xff; }
    auto ELF32_R_INFO(S, T)(S sym, T type) { return (sym << 8) + (type & 0xff); }
}

alias Elf_Note Elf32_Nhdr;

struct Elf32_Move
{
    Elf32_Lword   m_value;
    Elf32_Word    m_info;
    Elf32_Word    m_poffset;
    Elf32_Half    m_repeat;
    Elf32_Half    m_stride;
}

extern (D)
{
    auto ELF32_M_SYM(I)(I info) { return info >> 8; }
    auto ELF32_M_SIZE(I)(I info) { return cast(ubyte)info; }
    auto ELF32_M_INFO(S, SZ)(S sym, SZ size) { return (sym << 8) + cast(ubye)size; }
}

struct Elf32_Cap
{
    Elf32_Word    c_tag;
    union _c_un
    {
        Elf32_Word      c_val;
        Elf32_Addr      c_ptr;
    } _c_un c_un;
}

struct Elf32_Sym
{
    Elf32_Word    st_name;
    Elf32_Addr    st_value;
    Elf32_Word    st_size;
    ubyte st_info;
    ubyte st_other;
    Elf32_Half st_shndx;
}

extern (D)
{
    auto ELF32_ST_BIND(T)(T val) { return cast(ubyte)val >> 4; }
    auto ELF32_ST_TYPE(T)(T val) { return val & 0xf; }
    auto ELF32_ST_INFO(B, T)(B bind, T type) { return (bind << 4) + (type & 0xf); }
    auto ELF32_ST_VISIBILITY(O)(O o) { return o & 0x03; }
}

struct Elf32_Verdef
{
    Elf32_Half    vd_version;
    Elf32_Half    vd_flags;
    Elf32_Half    vd_ndx;
    Elf32_Half    vd_cnt;
    Elf32_Word    vd_hash;
    Elf32_Word    vd_aux;
    Elf32_Word    vd_next;
}

struct Elf32_Verdaux
{
    Elf32_Word    vda_name;
    Elf32_Word    vda_next;
}

struct Elf32_Verneed
{
    Elf32_Half    vn_version;
    Elf32_Half    vn_cnt;
    Elf32_Word    vn_file;
    Elf32_Word    vn_aux;
    Elf32_Word    vn_next;
}

struct Elf32_Vernaux
{
    Elf32_Word    vna_hash;
    Elf32_Half    vna_flags;
    Elf32_Half    vna_other;
    Elf32_Word    vna_name;
    Elf32_Word    vna_next;
}

alias Elf32_Half Elf32_Versym;

struct Elf32_Syminfo
{
    Elf32_Half si_boundto;
    Elf32_Half si_flags;
}
                                                                                                                                                                                                                                                                                                                                                                       /**
 * D header file for NetBSD.
 *
 * http://cvsweb.netbsd.org/bsdweb.cgi/~checkout~/src/sys/sys/exec_elf.h
 */
module core.sys.netbsd.sys.elf64;

version (NetBSD):
extern (C):
pure:
nothrow:

import core.stdc.stdint;
public import core.sys.netbsd.sys.elf_common;

alias uint16_t Elf64_Half;
alias uint32_t Elf64_Word;
alias int32_t  Elf64_Sword;
alias uint64_t Elf64_Lword;
alias uint64_t Elf64_Xword;
alias int64_t  Elf64_Sxword;
alias uint64_t Elf64_Addr;
alias uint64_t Elf64_Off;
alias Elf64_Word Elf64_Hashelt;
alias Elf64_Xword Elf64_Size;
alias Elf64_Sxword Elf64_Ssize;

struct Elf64_Ehdr
{
    char[EI_NIDENT] e_ident = 0;
    Elf64_Half    e_type;
    Elf64_Half    e_machine;
    Elf64_Word    e_version;
    Elf64_Addr    e_entry;
    Elf64_Off     e_phoff;
    Elf64_Off     e_shoff;
    Elf64_Word    e_flags;
    Elf64_Half    e_ehsize;
    Elf64_Half    e_phentsize;
    Elf64_Half    e_phnum;
    Elf64_Half    e_shentsize;
    Elf64_Half    e_shnum;
    Elf64_Half    e_shstrndx;
}

struct Elf64_Shdr
{
    Elf64_Word    sh_name;
    Elf64_Word    sh_type;
    Elf64_Xword   sh_flags;
    Elf64_Addr    sh_addr;
    Elf64_Off     sh_offset;
    Elf64_Xword   sh_size;
    Elf64_Word    sh_link;
    Elf64_Word    sh_info;
    Elf64_Xword   sh_addralign;
    Elf64_Xword   sh_entsize;
}

struct Elf64_Phdr
{
    Elf64_Word    p_type;
    Elf64_Word    p_flags;
    Elf64_Off     p_offset;
    Elf64_Addr    p_vaddr;
    Elf64_Addr    p_paddr;
    Elf64_Xword   p_filesz;
    Elf64_Xword   p_memsz;
    Elf64_Xword   p_align;
}

struct Elf64_Dyn
{
  Elf64_Sxword  d_tag;
  union _d_un
  {
      Elf64_Xword d_val;
      Elf64_Addr d_ptr;
  } _d_un d_un;
}

struct Elf64_Rel
{
    Elf64_Addr    r_offset;
    Elf64_Xword   r_info;
}

struct Elf64_Rela
{
    Elf64_Addr    r_offset;
    Elf64_Xword   r_info;
    Elf64_Sxword  r_addend;
}

extern (D)
{
    auto ELF64_R_SYM(I)(I i) { return i >> 32; }
    auto ELF64_R_TYPE(I)(I i) { return i & 0xffffffff; }
    auto ELF64_R_INFO(S, T)(S sym, T type) { return (sym << 32) + (type & 0xffffffff); }

    auto ELF64_R_TYPE_DATA(I)(I i) { return (cast(Elf64_Xword) i << 32) >> 40; }
    auto ELF64_R_TYPE_ID(I)(I i) { return (cast(Elf64_Xword) i << 56 ) >> 56; }
    auto ELF64_R_TYPE_INFO(D, T)(D d, T t) { return cast(Elf64_Xword) d << 8 + cast(Elf64_Xword) t; }
}

alias Elf_Note Elf64_Nhdr;

struct Elf64_Move
{
    Elf64_Lword   m_value;
    Elf64_Xword   m_info;
    Elf64_Xword   m_poffset;
    Elf64_Half    m_repeat;
    Elf64_Half    m_stride;
}

extern (D)
{
    auto ELF64_M_SYM(I)(I info) { return info >> 8; }
    auto ELF64_M_SIZE(I)(I info) { return cast(ubyte)info; }
    auto ELF64_M_INFO(S, SZ)(S sym, SZ size) { return (sym << 8) + cast(ubye)size; }
}

struct Elf64_Cap
{
    Elf64_Xword   c_tag;
    union _c_un
    {
        Elf64_Xword     c_val;
        Elf64_Addr      c_ptr;
    } _c_un c_un;
}

struct Elf64_Sym
{
    Elf64_Word    st_name;
    ubyte st_info;
    ubyte st_other;
    Elf64_Half st_shndx;
    Elf64_Addr    st_value;
    Elf64_Xword   st_size;
}

extern (D)
{
    auto ELF64_ST_BIND(T)(T val) { return cast(ubyte)val >> 4; }
    auto ELF64_ST_TYPE(T)(T val) { return val & 0xf; }
    auto ELF64_ST_INFO(B, T)(B bind, T type) { return (bind << 4) + (type & 0xf); }
    auto ELF64_ST_VISIBILITY(O)(O o) { return o & 0x03; }
}

struct Elf64_Verdef
{
    Elf64_Half    vd_version;
    Elf64_Half    vd_flags;
    Elf64_Half    vd_ndx;
    Elf64_Half    vd_cnt;
    Elf64_Word    vd_hash;
    Elf64_Word    vd_aux;
    Elf64_Word    vd_next;
}

struct Elf64_Verdaux
{
    Elf64_Word    vda_name;
    Elf64_Word    vda_next;
}

struct Elf64_Verneed
{
    Elf64_Half    vn_version;
    Elf64_Half    vn_cnt;
    Elf64_Word    vn_file;
    Elf64_Word    vn_aux;
    Elf64_Word    vn_next;
}

struct Elf64_Vernaux
{
    Elf64_Word    vna_hash;
    Elf64_Half    vna_flags;
    Elf64_Half    vna_other;
    Elf64_Word    vna_name;
    Elf64_Word    vna_next;
}

alias Elf64_Half Elf64_Versym;

struct Elf64_Syminfo
{
    Elf64_Half si_boundto;
    Elf64_Half si_flags;
}
                             /**
 * D header file for NetBSD.
 *
 * http://cvsweb.netbsd.org/bsdweb.cgi/~checkout~/src/sys/sys/exec_elf.h
 */
module core.sys.netbsd.sys.elf_common;

version (NetBSD):
extern (C):
pure:
nothrow:

import core.stdc.stdint;

struct Elf_Note
{
    uint32_t      n_namesz;
    uint32_t      n_descsz;
    uint32_t      n_type;
}

struct Elf_GNU_Hash_Header
{
    uint32_t      gh_nbuckets;
    uint32_t      gh_symndx;
    uint32_t      gh_maskwords;
    uint32_t      gh_shift2;
}

enum EI_MAG0 =         0;
enum EI_MAG1 =         1;
enum EI_MAG2 =         2;
enum EI_MAG3 =         3;
enum EI_CLASS =        4;
enum EI_DATA =         5;
enum EI_VERSION =      6;
enum EI_OSABI =        7;
enum EI_ABIVERSION =   8;
enum OLD_EI_BRAND =    8;
enum EI_PAD =          9;
enum EI_NIDENT =       16;

enum ELFMAG0 =         0x7f;
enum ELFMAG1 =         'E';
enum ELFMAG2 =         'L';
enum ELFMAG3 =         'F';
enum ELFMAG =          "\177ELF";
enum SELFMAG =         4;

enum EV_NONE =         0;
enum EV_CURRENT =      1;

enum ELFCLASSNONE =    0;
enum ELFCLASS32 =      1;
enum ELFCLASS64 =      2;

enum ELFDATANONE =     0;
enum ELFDATA2LSB =     1;
enum ELFDATA2MSB =     2;

enum ELFOSABI_NONE =           0;
enum ELFOSABI_SYSV =           0;
enum ELFOSABI_HPUX =           1;
enum ELFOSABI_NETBSD =         2;
enum ELFOSABI_LINUX =          3;
enum ELFOSABI_HURD  =          4;
enum ELFOSABI_86OPEN =         5;
enum ELFOSABI_SOLARIS =        6;
enum ELFOSABI_AIX =            7;
enum ELFOSABI_MONTEREY =       7;
enum ELFOSABI_IRIX =           8;
enum ELFOSABI_FREEBSD =        9;
enum ELFOSABI_TRU64 =          10;
enum ELFOSABI_MODESTO =        11;
enum ELFOSABI_OPENBSD =        12;
enum ELFOSABI_OPENVMS =        13;
enum ELFOSABI_NSK =            14;
enum ELFOSABI_AROS =           15;
enum ELFOSABI_ARM =            97;
enum ELFOSABI_STANDALONE =     255;
enum ELFOSABI_DRAGONFLYBSD =   ELFOSABI_NONE;

extern (D)
{
    auto IS_ELF(T)(T ehdr) { return ehdr.e_ident[EI_MAG0] == ELFMAG0 &&
                                    ehdr.e_ident[EI_MAG1] == ELFMAG1 &&
                                    ehdr.e_ident[EI_MAG2] == ELFMAG2 &&
                                    ehdr.e_ident[EI_MAG3] == ELFMAG3; }
}

enum ET_NONE =         0;
enum ET_REL =          1;
enum ET_EXEC =         2;
enum ET_DYN =          3;
enum ET_CORE =         4;
enum ET_LOOS =         0xfe00;
enum ET_HIOS =         0xfeff;
enum ET_LOPROC =       0xff00;
enum ET_HIPROC =       0xffff;

enum EM_NONE =          0;
enum EM_M32 =           1;
enum EM_SPARC =         2;
enum EM_386 =           3;
enum EM_68K =           4;
enum EM_88K =           5;
enum EM_860 =           7;
enum EM_MIPS =          8;
enum EM_S370 =          9;
enum EM_MIPS_RS3_LE =  10;
enum EM_PARISC =       15;
enum EM_VPP500 =       17;
enum EM_SPARC32PLUS =  18;
enum EM_960 =          19;
enum EM_PPC =          20;
enum EM_PPC64 =        21;
enum EM_S390 =         22;
enum EM_V800 =         36;
enum EM_FR20 =         37;
enum EM_RH32 =         38;
enum EM_RCE =          39;
enum EM_ARM =          40;
enum EM_SH =           42;
enum EM_SPARCV9 =      43;
enum EM_TRICORE =      44;
enum EM_ARC =          45;
enum EM_H8_300 =       46;
enum EM_H8_300H =      47;
enum EM_H8S =          48;
enum EM_H8_500 =       49;
enum EM_IA_64 =        50;
enum EM_MIPS_X =       51;
enum EM_COLDFIRE =     52;
enum EM_68HC12 =       53;
enum EM_MMA =          54;
enum EM_PCP =          55;
enum EM_NCPU =         56;
enum EM_NDR1 =         57;
enum EM_STARCORE =     58;
enum EM_ME16 =         59;
enum EM_ST100 =        60;
enum EM_TINYJ =        61;
enum EM_X86_64 =       62;
enum EM_AMD64 =        62;
enum EM_PDSP =         63;
enum EM_FX66 =         66;
enum EM_ST9PLUS =      67;
enum EM_ST7 =          68;
enum EM_68HC16 =       69;
enum EM_68HC11 =       70;
enum EM_68HC08 =       71;
enum EM_68HC05 =       72;
enum EM_SVX =          73;
enum EM_ST19 =         74;
enum EM_VAX =          75;
enum EM_CRIS =         76;
enum EM_JAVELIN =      77;
enum EM_FIREPATH =     78;
enum EM_ZSP =          79;
enum EM_MMIX =         80;
enum EM_HUANY =        81;
enum EM_PRISM =        82;
enum EM_AVR =          83;
enum EM_FR30 =         84;
enum EM_D10V =         85;
enum EM_D30V =         86;
enum EM_V850 =         87;
enum EM_M32R =         88;
enum EM_MN10300 =      89;
enum EM_MN10200 =      90;
enum EM_PJ =           91;
enum EM_OPENRISC =     92;
enum EM_ARC_A5 =       93;
enum EM_XTENSA =       94;
enum EM_VIDEOCORE =    95;
enum EM_TMM_GPP =      96;
enum EM_NS32K =        97;
enum EM_TPC =          98;
enum EM_SNP1K =        99;
enum EM_ST200 =       100;
enum EM_IP2K =        101;
enum EM_MAX =         102;
enum EM_CR =          103;
enum EM_F2MC16 =      104;
enum EM_MSP430 =      105;
enum EM_BLACKFIN =    106;
enum EM_SE_C33 =      107;
enum EM_SEP =         108;
enum EM_ARCA =        109;
enum EM_UNICORE =     110;
enum EM_AARCH64 =     183;     /* AArch64 64-bit ARM microprocessor */

/* Unofficial machine types follow */
enum EM_AVR32  =       6317;    /* used by NetBSD/avr32 */
enum EM_ALPHA_EXP  =  36902;   /* used by NetBSD/alpha; obsolete */

enum EM_486 =           6;
enum EM_MIPS_RS4_BE =  10;
enum EM_ALPHA_STD =    41;
enum EM_ALPHA =    0x9026;

enum SHN_UNDEF =       0;
enum SHN_LORESERVE =   0xff00;
enum SHN_LOPROC =      0xff00;
enum SHN_HIPROC =      0xff1f;
enum SHN_LOOS =        0xff20;
enum SHN_HIOS =        0xff3f;
enum SHN_ABS =         0xfff1;
enum SHN_COMMON =      0xfff2;
enum SHN_XINDEX =      0xffff;
enum SHN_HIRESERVE =   0xffff;

enum SHT_NULL =          0;
enum SHT_PROGBITS =      1;
enum SHT_SYMTAB =        2;
enum SHT_STRTAB =        3;
enum SHT_RELA =          4;
enum SHT_HASH =          5;
enum SHT_DYNAMIC =       6;
enum SHT_NOTE =          7;
enum SHT_NOBITS =        8;
enum SHT_REL =           9;
enum SHT_SHLIB =         10;
enum SHT_DYNSYM =        11;
enum SHT_INIT_ARRAY =    14;
enum SHT_FINI_ARRAY =    15;
enum SHT_PREINIT_ARRAY = 16;
enum SHT_GROUP =         17;
enum SHT_SYMTAB_SHNDX =  18;
enum SHT_LOOS =          0x60000000;
enum SHT_LOSUNW =        0x6ffffff4;
enum SHT_SUNW_dof =      0x6ffffff4;
enum SHT_SUNW_cap =      0x6ffffff5;
enum SHT_SUNW_SIGNATURE = 0x6ffffff6;
enum SHT_GNU_HASH =      0x6ffffff6;
enum SHT_SUNW_ANNOTATE = 0x6ffffff7;
enum SHT_SUNW_DEBUGSTR = 0x6ffffff8;
enum SHT_SUNW_DEBUG =    0x6ffffff9;
enum SHT_SUNW_move =     0x6ffffffa;
enum SHT_SUNW_COMDAT =   0x6ffffffb;
enum SHT_SUNW_syminfo =  0x6ffffffc;
enum SHT_SUNW_verdef =   0x6ffffffd;
enum SHT_GNU_verdef =    0x6ffffffd;
enum SHT_SUNW_verneed =  0x6ffffffe;
enum SHT_GNU_verneed =   0x6ffffffe;
enum SHT_SUNW_versym =   0x6fffffff;
enum SHT_GNU_versym =    0x6fffffff;
enum SHT_HISUNW =        0x6fffffff;
enum SHT_HIOS =          0x6fffffff;
enum SHT_LOPROC =        0x70000000;
enum SHT_AMD64_UNWIND =  0x70000001;
enum SHT_ARM_EXIDX =     0x70000001;
enum SHT_ARM_PREEMPTMAP = 0x70000002;
enum SHT_ARM_ATTRIBUTES = 0x70000003;
enum SHT_ARM_DEBUGOVERLAY = 0x70000004;
enum SHT_ARM_OVERLAYSECTION = 0x70000005;
enum SHT_MIPS_REGINFO =  0x70000006;
enum SHT_MIPS_OPTIONS =  0x7000000d;
enum SHT_MIPS_DWARF =    0x7000001e;
enum SHT_HIPROC =        0x7fffffff;
enum SHT_LOUSER =        0x80000000;
enum SHT_HIUSER =        0x8fffffff;

enum SHF_WRITE =            (1 << 0);
enum SHF_ALLOC =            (1 << 1);
enum SHF_EXECINSTR =        (1 << 2);
enum SHF_MERGE =            (1 << 4);
enum SHF_STRINGS =          (1 << 5);
enum SHF_INFO_LINK =        (1 << 6);
enum SHF_LINK_ORDER =       (1 << 7);
enum SHF_OS_NONCONFORMING = (1 << 8);
enum SHF_GROUP =            (1 << 9);
enum SHF_TLS =              (1 << 10);
enum SHF_MASKOS =           0x0ff00000;
enum SHF_MASKPROC =         0xf0000000;

enum PT_NULL =         0;
enum PT_LOAD =         1;
enum PT_DYNAMIC =      2;
enum PT_INTERP =       3;
enum PT_NOTE =         4;
enum PT_SHLIB =        5;
enum PT_PHDR =         6;
enum PT_TLS =          7;
enum PT_LOOS =         0x60000000;
enum PT_SUNW_UNWIND =  0x6464e550;
enum PT_GNU_EH_FRAME = 0x6474e550;
enum PT_GNU_STACK =    0x6474e551;
enum PT_GNU_RELRO =    0x6474e552;
enum PT_LOSUNW =       0x6ffffffa;
enum PT_SUNWBSS =      0x6ffffffa;
enum PT_SUNWSTACK =    0x6ffffffb;
enum PT_SUNWDTRACE =   0x6ffffffc;
enum PT_SUNWCAP =      0x6ffffffd;
enum PT_HISUNW =       0x6fffffff;
enum PT_HIOS =         0x6fffffff;
enum PT_LOPROC =       0x70000000;
enum PT_HIPROC =       0x7fffffff;

enum PF_X =            (1 << 0);
enum PF_W =            (1 << 1);
enum PF_R =            (1 << 2);
enum PF_MASKOS =       0x0ff00000;
enum PF_MASKPROC =     0xf0000000;

enum PN_XNUM =         0xffff;

enum DT_NULL =         0;
enum DT_NEEDED =       1;
enum DT_PLTRELSZ =     2;
enum DT_PLTGOT =       3;
enum DT_HASH =         4;
enum DT_STRTAB =       5;
enum DT_SYMTAB =       6;
enum DT_RELA =         7;
enum DT_RELASZ =       8;
enum DT_RELAENT =      9;
enum DT_STRSZ =        10;
enum DT_SYMENT =       11;
enum DT_INIT =         12;
enum DT_FINI =         13;
enum DT_SONAME =       14;
enum DT_RPATH =        15;
enum DT_SYMBOLIC =     16;
enum DT_REL =          17;
enum DT_RELSZ =        18;
enum DT_RELENT =       19;
enum DT_PLTREL =       20;
enum DT_DEBUG =        21;
enum DT_TEXTREL =      22;
enum DT_JMPREL =       23;
enum DT_BIND_NOW =     24;
enum DT_INIT_ARRAY =   25;
enum DT_FINI_ARRAY =   26;
enum DT_INIT_ARRAYSZ = 27;
enum DT_FINI_ARRAYSZ = 28;
enum DT_RUNPATH =      29;
enum DT_FLAGS =        30;
enum DT_ENCODING =     32;
enum DT_PREINIT_ARRAY = 32;
enum DT_PREINIT_ARRAYSZ = 33;
enum DT_MAXPOSTAGS =   34;
enum DT_LOOS =         0x6000000d;
enum DT_SUNW_AUXILIARY = 0x6000000d;
enum DT_SUNW_RTLDINF = 0x6000000e;
enum DT_SUNW_FILTER =  0x6000000f;
enum DT_SUNW_CAP =     0x60000010;
enum DT_HIOS =         0x6ffff000;
enum DT_VALRNGLO =     0x6ffffd00;
enum DT_CHECKSUM =     0x6ffffdf8;
enum DT_PLTPADSZ =     0x6ffffdf9;
enum DT_MOVEENT =      0x6ffffdfa;
enum DT_MOVESZ =       0x6ffffdfb;
enum DT_FEATURE_1 =    0x6ffffdfc;
enum DT_POSFLAG_1 =    0x6ffffdfd;
enum DT_SYMINSZ =      0x6ffffdfe;
enum DT_SYMINENT =     0x6ffffdff;
enum DT_VALRNGHI =     0x6ffffdff;
enum DT_ADDRRNGLO =    0x6ffffe00;
enum DT_GNU_HASH =     0x6ffffef5;
enum DT_CONFIG =       0x6ffffefa;
enum DT_DEPAUDIT =     0x6ffffefb;
enum DT_AUDIT =        0x6ffffefc;
enum DT_PLTPAD =       0x6ffffefd;
enum DT_MOVETAB =      0x6ffffefe;
enum DT_SYMINFO =      0x6ffffeff;
enum DT_ADDRRNGHI =    0x6ffffeff;
enum DT_VERSYM =       0x6ffffff0;
enum DT_RELACOUNT =    0x6ffffff9;
enum DT_RELCOUNT =     0x6ffffffa;
enum DT_FLAGS_1 =      0x6ffffffb;
enum DT_VERDEF =       0x6ffffffc;
enum DT_VERDEFNUM =    0x6ffffffd;
enum DT_VERNEED =      0x6ffffffe;
enum DT_VERNEEDNUM =   0x6fffffff;
enum DT_LOPROC =       0x70000000;
enum DT_DEPRECATED_SPARC_REGISTER = 0x7000001;
enum DT_AUXILIARY =    0x7ffffffd;
enum DT_USED =         0x7ffffffe;
enum DT_FILTER =       0x7fffffff;
enum DT_HIPROC =       0x7fffffff;

enum DF_ORIGIN =       0x00000001;
enum DF_SYMBOLIC =     0x00000002;
enum DF_TEXTREL =      0x00000004;
enum DF_BIND_NOW =     0x00000008;
enum DF_STATIC_TLS =   0x00000010;

enum DF_1_BIND_NOW =   0x00000001;
enum DF_1_GLOBAL =     0x00000002;
enum DF_1_NODELETE =   0x00000008;
enum DF_1_LOADFLTR =   0x00000010;
enum DF_1_NOOPEN =     0x00000040;
enum DF_1_NODEFLIB =   0x00000800;

enum NT_PRSTATUS =     1;
enum NT_FPREGSET =     2;
enum NT_PRPSINFO =     3;
enum NT_THRMISC =      7;
enum NT_PROCSTAT_PROC = 8;
enum NT_PROCSTAT_FILES = 9;
enum NT_PROCSTAT_VMMAP = 10;
enum NT_PROCSTAT_GROUPS = 11;
enum NT_PROCSTAT_UMASK = 12;
enum NT_PROCSTAT_RLIMIT = 13;
enum NT_PROCSTAT_OSREL = 14;
enum NT_PROCSTAT_PSSTRINGS = 15;
enum NT_PROCSTAT_AUXV = 16;

enum STB_LOCAL =       0;
enum STB_GLOBAL =      1;
enum STB_WEAK =        2;
enum STB_NUM =         3;
enum STB_LOOS =        10;
enum STB_HIOS =        12;
enum STB_LOPROC =      13;
enum STB_HIPROC =      15;

enum STT_NOTYPE =      0;
enum STT_OBJECT =      1;
enum STT_FUNC =        2;
enum STT_SECTION =     3;
enum STT_FILE =        4;
enum STT_COMMON =      5;
enum STT_TLS =         6;
enum STT_NUM =         7;
enum STT_LOOS =        10;
enum STT_GNU_IFUNC =   10;
enum STT_HIOS =        12;
enum STT_LOPROC =      13;
enum STT_HIPROC =      15;

enum STV_DEFAULT =     0;
enum STV_INTERNAL =    1;
enum STV_HIDDEN =      2;
enum STV_PROTECTED =   3;
enum STV_EXPORTED =    4;
enum STV_SINGLETON =   5;
enum STV_ELIMINATE =   6;

enum STN_UNDEF =       0;

enum VER_DEF_CURRENT = 1;
alias VER_NDX VER_DEF_IDX;

enum VER_FLG_BASE =    0x1;
enum VER_FLG_WEAK =    0x2;

enum VER_NEED_CURRENT = 1;
enum VER_NEED_WEAK =    32768;
enum VER_NEED_HIDDEN = VER_NDX_HIDDEN;
alias VER_NDX VER_NEED_IDX;

enum VER_NDX_LOCAL =           0;
enum VER_NDX_GLOBAL =          1;
enum VER_NDX_GIVEN =           2;

enum VER_NDX_HIDDEN =      32768;
extern (D)
{
    auto VER_NDX(V)(V v) { return v & ~(1u << 15); }
}

enum CA_SUNW_NULL =    0;
enum CA_SUNW_HW_1 =    1;
enum CA_SUNW_SF_1 =    2;

enum SYMINFO_FLG_DIRECT =      0x0001;
enum SYMINFO_FLG_PASSTHRU =    0x0002;
enum SYMINFO_FLG_COPY =        0x0004;
enum SYMINFO_FLG_LAZYLOAD =    0x0008;
enum SYMINFO_FLG_DIRECTBIND =  0x0010;
enum SYMINFO_FLG_NOEXTDIRECT = 0x0020;
enum SYMINFO_FLG_FILTER =      0x0002;
enum SYMINFO_FLG_AUXILIARY =   0x0040;

enum SYMINFO_BT_SELF =         0xffff;
enum SYMINFO_BT_PARENT =       0xfffe;
enum SYMINFO_BT_NONE =         0xfffd;
enum SYMINFO_BT_EXTERN =       0xfffc;
enum SYMINFO_BT_LOWRESERVE =   0xff00;

enum SYMINFO_NONE =            0;
enum SYMINFO_CURRENT =         1;
enum SYMINFO_NUM =             2;

enum R_386_NONE =               0;
enum R_386_32 =                 1;
enum R_386_PC32 =               2;
enum R_386_GOT32 =              3;
enum R_386_PLT32 =              4;
enum R_386_COPY =               5;
enum R_386_GLOB_DAT =           6;
enum R_386_JMP_SLOT =           7;
enum R_386_RELATIVE =           8;
enum R_386_GOTOFF =             9;
enum R_386_GOTPC =              10;
enum R_386_TLS_TPOFF =          14;
enum R_386_TLS_IE =             15;
enum R_386_TLS_GOTIE =          16;
enum R_386_TLS_LE =             17;
enum R_386_TLS_GD =             18;
enum R_386_TLS_LDM =            19;
enum R_386_TLS_GD_32 =          24;
enum R_386_TLS_GD_PUSH =        25;
enum R_386_TLS_GD_CALL =        26;
enum R_386_TLS_GD_POP =         27;
enum R_386_TLS_LDM_32 =         28;
enum R_386_TLS_LDM_PUSH =       29;
enum R_386_TLS_LDM_CALL =       30;
enum R_386_TLS_LDM_POP =        31;
enum R_386_TLS_LDO_32 =         32;
enum R_386_TLS_IE_32 =          33;
enum R_386_TLS_LE_32 =          34;
enum R_386_TLS_DTPMOD32 =       35;
enum R_386_TLS_DTPOFF32 =       36;
enum R_386_TLS_TPOFF32 =        37;
enum R_386_IRELATIVE =          42;

enum R_ARM_NONE =               0;
enum R_ARM_PC24 =               1;
enum R_ARM_ABS32 =              2;
enum R_ARM_REL32 =              3;
enum R_ARM_PC13 =               4;
enum R_ARM_ABS16 =              5;
enum R_ARM_ABS12 =              6;
enum R_ARM_THM_ABS5 =           7;
enum R_ARM_ABS8 =               8;
enum R_ARM_SBREL32 =            9;
enum R_ARM_THM_PC22 =           10;
enum R_ARM_THM_PC8 =            11;
enum R_ARM_AMP_VCALL9 =         12;
enum R_ARM_SWI24 =              13;
enum R_ARM_THM_SWI8 =           14;
enum R_ARM_XPC25 =              15;
enum R_ARM_THM_XPC22 =          16;
enum R_ARM_TLS_DTPMOD32 =       17;
enum R_ARM_TLS_DTPOFF32 =       18;
enum R_ARM_TLS_TPOFF32 =        19;
enum R_ARM_COPY =               20;
enum R_ARM_GLOB_DAT =           21;
enum R_ARM_JUMP_SLOT =          22;
enum R_ARM_RELATIVE =           23;
enum R_ARM_GOTOFF =             24;
enum R_ARM_GOTPC =              25;
enum R_ARM_GOT32 =              26;
enum R_ARM_PLT32 =              27;
enum R_ARM_GNU_VTENTRY =        100;
enum R_ARM_GNU_VTINHERIT =      101;
enum R_ARM_RSBREL32 =           250;
enum R_ARM_THM_RPC22 =          251;
enum R_ARM_RREL32 =             252;
enum R_ARM_RABS32 =             253;
enum R_ARM_RPC24 =              254;
enum R_ARM_RBASE =              255;

enum R_IA_64_NONE =             0;
enum R_IA_64_IMM14 =            0x21;
enum R_IA_64_IMM22 =            0x22;
enum R_IA_64_IMM64 =            0x23;
enum R_IA_64_DIR32MSB =         0x24;
enum R_IA_64_DIR32LSB =         0x25;
enum R_IA_64_DIR64MSB =         0x26;
enum R_IA_64_DIR64LSB =         0x27;
enum R_IA_64_GPREL22 =          0x2a;
enum R_IA_64_GPREL64I =         0x2b;
enum R_IA_64_GPREL32MSB =       0x2c;
enum R_IA_64_GPREL32LSB =       0x2d;
enum R_IA_64_GPREL64MSB =       0x2e;
enum R_IA_64_GPREL64LSB =       0x2f;
enum R_IA_64_LTOFF22 =          0x32;
enum R_IA_64_LTOFF64I =         0x33;
enum R_IA_64_PLTOFF22 =         0x3a;
enum R_IA_64_PLTOFF64I =        0x3b;
enum R_IA_64_PLTOFF64MSB =      0x3e;
enum R_IA_64_PLTOFF64LSB =      0x3f;
enum R_IA_64_FPTR64I =          0x43;
enum R_IA_64_FPTR32MSB =        0x44;
enum R_IA_64_FPTR32LSB =        0x45;
enum R_IA_64_FPTR64MSB =        0x46;
enum R_IA_64_FPTR64LSB =        0x47;
enum R_IA_64_PCREL60B =         0x48;
enum R_IA_64_PCREL21B =         0x49;
enum R_IA_64_PCREL21M =         0x4a;
enum R_IA_64_PCREL21F =         0x4b;
enum R_IA_64_PCREL32MSB =       0x4c;
enum R_IA_64_PCREL32LSB =       0x4d;
enum R_IA_64_PCREL64MSB =       0x4e;
enum R_IA_64_PCREL64LSB =       0x4f;
enum R_IA_64_LTOFF_FPTR22 =     0x52;
enum R_IA_64_LTOFF_FPTR64I =    0x53;
enum R_IA_64_LTOFF_FPTR32MSB =  0x54;
enum R_IA_64_LTOFF_FPTR32LSB =  0x55;
enum R_IA_64_LTOFF_FPTR64MSB =  0x56;
enum R_IA_64_LTOFF_FPTR64LSB =  0x57;
enum R_IA_64_SEGREL32MSB =      0x5c;
enum R_IA_64_SEGREL32LSB =      0x5d;
enum R_IA_64_SEGREL64MSB =      0x5e;
enum R_IA_64_SEGREL64LSB =      0x5f;
enum R_IA_64_SECREL32MSB =      0x64;
enum R_IA_64_SECREL32LSB =      0x65;
enum R_IA_64_SECREL64MSB =      0x66;
enum R_IA_64_SECREL64LSB =      0x67;
enum R_IA_64_REL32MSB =         0x6c;
enum R_IA_64_REL32LSB =         0x6d;
enum R_IA_64_REL64MSB =         0x6e;
enum R_IA_64_REL64LSB =         0x6f;
enum R_IA_64_LTV32MSB =         0x74;
enum R_IA_64_LTV32LSB =         0x75;
enum R_IA_64_LTV64MSB =         0x76;
enum R_IA_64_LTV64LSB =         0x77;
enum R_IA_64_PCREL21BI =        0x79;
enum R_IA_64_PCREL22 =          0x7a;
enum R_IA_64_PCREL64I =         0x7b;
enum R_IA_64_IPLTMSB =          0x80;
enum R_IA_64_IPLTLSB =          0x81;
enum R_IA_64_SUB =              0x85;
enum R_IA_64_LTOFF22X =         0x86;
enum R_IA_64_LDXMOV =           0x87;
enum R_IA_64_TPREL14 =          0x91;
enum R_IA_64_TPREL22 =          0x92;
enum R_IA_64_TPREL64I =         0x93;
enum R_IA_64_TPREL64MSB =       0x96;
enum R_IA_64_TPREL64LSB =       0x97;
enum R_IA_64_LTOFF_TPREL22 =    0x9a;
enum R_IA_64_DTPMOD64MSB =      0xa6;
enum R_IA_64_DTPMOD64LSB =      0xa7;
enum R_IA_64_LTOFF_DTPMOD22 =   0xaa;
enum R_IA_64_DTPREL14 =         0xb1;
enum R_IA_64_DTPREL22 =         0xb2;
enum R_IA_64_DTPREL64I =        0xb3;
enum R_IA_64_DTPREL32MSB =      0xb4;
enum R_IA_64_DTPREL32LSB =      0xb5;
enum R_IA_64_DTPREL64MSB =      0xb6;
enum R_IA_64_DTPREL64LSB =      0xb7;
enum R_IA_64_LTOFF_DTPREL22 =   0xba;

enum R_MIPS_NONE =              0;
enum R_MIPS_16 =                1;
enum R_MIPS_32 =                2;
enum R_MIPS_REL32 =             3;
enum R_MIPS_26 =                4;
enum R_MIPS_HI16 =              5;
enum R_MIPS_LO16 =              6;
enum R_MIPS_GPREL16 =           7;
enum R_MIPS_LITERAL =           8;
enum R_MIPS_GOT16 =             9;
enum R_MIPS_PC16 =              10;
enum R_MIPS_CALL16 =            11;
enum R_MIPS_GPREL32 =           12;
enum R_MIPS_GOTHI16 =           21;
enum R_MIPS_GOTLO16 =           22;
enum R_MIPS_CALLHI16 =          30;
enum R_MIPS_CALLLO16 =          31;

enum R_PPC_NONE =               0;
enum R_PPC_ADDR32 =             1;
enum R_PPC_ADDR24 =             2;
enum R_PPC_ADDR16 =             3;
enum R_PPC_ADDR16_LO =          4;
enum R_PPC_ADDR16_HI =          5;
enum R_PPC_ADDR16_HA =          6;
enum R_PPC_ADDR14 =             7;
enum R_PPC_ADDR14_BRTAKEN =     8;
enum R_PPC_ADDR14_BRNTAKEN =    9;
enum R_PPC_REL24 =              10;
enum R_PPC_REL14 =              11;
enum R_PPC_REL14_BRTAKEN =      12;
enum R_PPC_REL14_BRNTAKEN =     13;
enum R_PPC_GOT16 =              14;
enum R_PPC_GOT16_LO =           15;
enum R_PPC_GOT16_HI =           16;
enum R_PPC_GOT16_HA =           17;
enum R_PPC_PLTREL24 =           18;
enum R_PPC_COPY =               19;
enum R_PPC_GLOB_DAT =           20;
enum R_PPC_JMP_SLOT =           21;
enum R_PPC_RELATIVE =           22;
enum R_PPC_LOCAL24PC =          23;
enum R_PPC_UADDR32 =            24;
enum R_PPC_UADDR16 =            25;
enum R_PPC_REL32 =              26;
enum R_PPC_PLT32 =              27;
enum R_PPC_PLTREL32 =           28;
enum R_PPC_PLT16_LO =           29;
enum R_PPC_PLT16_HI =           30;
enum R_PPC_PLT16_HA =           31;
enum R_PPC_SDAREL16 =           32;
enum R_PPC_SECTOFF =            33;
enum R_PPC_SECTOFF_LO =         34;
enum R_PPC_SECTOFF_HI =         35;
enum R_PPC_SECTOFF_HA =         36;

enum R_PPC64_ADDR64 =           38;
enum R_PPC64_ADDR16_HIGHER =    39;
enum R_PPC64_ADDR16_HIGHERA =   40;
enum R_PPC64_ADDR16_HIGHEST =   41;
enum R_PPC64_ADDR16_HIGHESTA =  42;
enum R_PPC64_UADDR64 =          43;
enum R_PPC64_REL64 =            44;
enum R_PPC64_PLT64 =            45;
enum R_PPC64_PLTREL64 =         46;
enum R_PPC64_TOC16 =            47;
enum R_PPC64_TOC16_LO =         48;
enum R_PPC64_TOC16_HI =         49;
enum R_PPC64_TOC16_HA =         50;
enum R_PPC64_TOC =              51;
enum R_PPC64_DTPMOD64 =         68;
enum R_PPC64_TPREL64 =          73;
enum R_PPC64_DTPREL64 =         78;

enum R_PPC_TLS =                67;
enum R_PPC_DTPMOD32 =           68;
enum R_PPC_TPREL16 =            69;
enum R_PPC_TPREL16_LO =         70;
enum R_PPC_TPREL16_HI =         71;
enum R_PPC_TPREL16_HA =         72;
enum R_PPC_TPREL32 =            73;
enum R_PPC_DTPREL16 =           74;
enum R_PPC_DTPREL16_LO =        75;
enum R_PPC_DTPREL16_HI =        76;
enum R_PPC_DTPREL16_HA =        77;
enum R_PPC_DTPREL32 =           78;
enum R_PPC_GOT_TLSGD16 =        79;
enum R_PPC_GOT_TLSGD16_LO =     80;
enum R_PPC_GOT_TLSGD16_HI =     81;
enum R_PPC_GOT_TLSGD16_HA =     82;
enum R_PPC_GOT_TLSLD16 =        83;
enum R_PPC_GOT_TLSLD16_LO =     84;
enum R_PPC_GOT_TLSLD16_HI =     85;
enum R_PPC_GOT_TLSLD16_HA =     86;
enum R_PPC_GOT_TPREL16 =        87;
enum R_PPC_GOT_TPREL16_LO =     88;
enum R_PPC_GOT_TPREL16_HI =     89;
enum R_PPC_GOT_TPREL16_HA =     90;

enum R_PPC_EMB_NADDR32 =        101;
enum R_PPC_EMB_NADDR16 =        102;
enum R_PPC_EMB_NADDR16_LO =     103;
enum R_PPC_EMB_NADDR16_HI =     104;
enum R_PPC_EMB_NADDR16_HA =     105;
enum R_PPC_EMB_SDAI16 =         106;
enum R_PPC_EMB_SDA2I16 =        107;
enum R_PPC_EMB_SDA2REL =        108;
enum R_PPC_EMB_SDA21 =          109;
enum R_PPC_EMB_MRKREF =         110;
enum R_PPC_EMB_RELSEC16 =       111;
enum R_PPC_EMB_RELST_LO =       112;
enum R_PPC_EMB_RELST_HI =       113;
enum R_PPC_EMB_RELST_HA =       114;
enum R_PPC_EMB_BIT_FLD =        115;
enum R_PPC_EMB_RELSDA =         116;

enum R_SPARC_NONE =             0;
enum R_SPARC_8 =                1;
enum R_SPARC_16 =               2;
enum R_SPARC_32 =               3;
enum R_SPARC_DISP8 =            4;
enum R_SPARC_DISP16 =           5;
enum R_SPARC_DISP32 =           6;
enum R_SPARC_WDISP30 =          7;
enum R_SPARC_WDISP22 =          8;
enum R_SPARC_HI22 =             9;
enum R_SPARC_22 =               10;
enum R_SPARC_13 =               11;
enum R_SPARC_LO10 =             12;
enum R_SPARC_GOT10 =            13;
enum R_SPARC_GOT13 =            14;
enum R_SPARC_GOT22 =            15;
enum R_SPARC_PC10 =             16;
enum R_SPARC_PC22 =             17;
enum R_SPARC_WPLT30 =           18;
enum R_SPARC_COPY =             19;
enum R_SPARC_GLOB_DAT =         20;
enum R_SPARC_JMP_SLOT =         21;
enum R_SPARC_RELATIVE =         22;
enum R_SPARC_UA32 =             23;
enum R_SPARC_PLT32 =            24;
enum R_SPARC_HIPLT22 =          25;
enum R_SPARC_LOPLT10 =          26;
enum R_SPARC_PCPLT32 =          27;
enum R_SPARC_PCPLT22 =          28;
enum R_SPARC_PCPLT10 =          29;
enum R_SPARC_10 =               30;
enum R_SPARC_11 =               31;
enum R_SPARC_64 =               32;
enum R_SPARC_OLO10 =            33;
enum R_SPARC_HH22 =             34;
enum R_SPARC_HM10 =             35;
enum R_SPARC_LM22 =             36;
enum R_SPARC_PC_HH22 =          37;
enum R_SPARC_PC_HM10 =          38;
enum R_SPARC_PC_LM22 =          39;
enum R_SPARC_WDISP16 =          40;
enum R_SPARC_WDISP19 =          41;
enum R_SPARC_GLOB_JMP =         42;
enum R_SPARC_7 =                43;
enum R_SPARC_5 =                44;
enum R_SPARC_6 =                45;
enum R_SPARC_DISP64 =           46;
enum R_SPARC_PLT64 =            47;
enum R_SPARC_HIX22 =            48;
enum R_SPARC_LOX10 =            49;
enum R_SPARC_H44 =              50;
enum R_SPARC_M44 =              51;
enum R_SPARC_L44 =              52;
enum R_SPARC_REGISTER =         53;
enum R_SPARC_UA64 =             54;
enum R_SPARC_UA16 =             55;
enum R_SPARC_TLS_GD_HI22 =      56;
enum R_SPARC_TLS_GD_LO10 =      57;
enum R_SPARC_TLS_GD_ADD =       58;
enum R_SPARC_TLS_GD_CALL =      59;
enum R_SPARC_TLS_LDM_HI22 =     60;
enum R_SPARC_TLS_LDM_LO10 =     61;
enum R_SPARC_TLS_LDM_ADD =      62;
enum R_SPARC_TLS_LDM_CALL =     63;
enum R_SPARC_TLS_LDO_HIX22 =    64;
enum R_SPARC_TLS_LDO_LOX10 =    65;
enum R_SPARC_TLS_LDO_ADD =      66;
enum R_SPARC_TLS_IE_HI22 =      67;
enum R_SPARC_TLS_IE_LO10 =      68;
enum R_SPARC_TLS_IE_LD =        69;
enum R_SPARC_TLS_IE_LDX =       70;
enum R_SPARC_TLS_IE_ADD =       71;
enum R_SPARC_TLS_LE_HIX22 =     72;
enum R_SPARC_TLS_LE_LOX10 =     73;
enum R_SPARC_TLS_DTPMOD32 =     74;
enum R_SPARC_TLS_DTPMOD64 =     75;
enum R_SPARC_TLS_DTPOFF32 =     76;
enum R_SPARC_TLS_DTPOFF64 =     77;
enum R_SPARC_TLS_TPOFF32 =      78;
enum R_SPARC_TLS_TPOFF64 =      79;

enum R_X86_64_NONE =            0;
enum R_X86_64_64 =              1;
enum R_X86_64_PC32 =            2;
enum R_X86_64_GOT32 =           3;
enum R_X86_64_PLT32 =           4;
enum R_X86_64_COPY =            5;
enum R_X86_64_GLOB_DAT =        6;
enum R_X86_64_JMP_SLOT =        7;
enum R_X86_64_RELATIVE =        8;
enum R_X86_64_GOTPCREL =        9;
enum R_X86_64_32 =              10;
enum R_X86_64_32S =             11;
enum R_X86_64_16 =              12;
enum R_X86_64_PC16 =            13;
enum R_X86_64_8 =               14;
enum R_X86_64_PC8 =             15;
enum R_X86_64_DTPMOD64 =        16;
enum R_X86_64_DTPOFF64 =        17;
enum R_X86_64_TPOFF64 =         18;
enum R_X86_64_TLSGD =           19;
enum R_X86_64_TLSLD =           20;
enum R_X86_64_DTPOFF32 =        21;
enum R_X86_64_GOTTPOFF =        22;
enum R_X86_64_TPOFF32 =         23;
enum R_X86_64_IRELATIVE =       37;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /**
 * D header file for NetBSD.
 *
 * Copyright: Copyright Martin Nowak 2012.
 * License:   $(HTTP www.boost.org/LICENSE_1_0.txt, Boost License 1.0).
 * Authors:   Martin Nowak
 *
 * http://cvsweb.netbsd.org/bsdweb.cgi/~checkout~/src/sys/sys/event.h
 */

/*          Copyright Martin Nowak 2012.
 * Distributed under the Boost Software License, Version 1.0.
 *    (See accompanying file LICENSE or copy at
 *          http://www.boost.org/LICENSE_1_0.txt)
 */
module core.sys.netbsd.sys.event;

version (NetBSD):
extern (C):

import core.stdc.stdint;    // intptr_t, uintptr_t
import core.sys.posix.time; // timespec


enum
{
    EVFILT_READ     =  0,
    EVFILT_WRITE    =  1,
    EVFILT_AIO      =  2,
    EVFILT_VNODE    =  3,
    EVFILT_PROC     =  4,
    EVFILT_SIGNAL   =  5,
    EVFILT_TIMER    =  6,
    EVFILT_SYSCOUNT =  7
}

extern(D) void EV_SET(kevent_t* kevp, typeof(kevent_t.tupleof) args)
{
    *kevp = kevent_t(args);
}

struct kevent_t
{
    uintptr_t    ident;
    uint        filter;
    uint        flags;
    uint        fflags;
    ulong       data;
    void        *udata;
}

enum
{
    /* actions */
    EV_ADD      = 0x0001,
    EV_DELETE   = 0x0002,
    EV_ENABLE   = 0x0004,
    EV_DISABLE  = 0x0008,

    /* flags */
    EV_ONESHOT  = 0x0010,
    EV_CLEAR    = 0x0020,

    EV_SYSFLAGS = 0xF000,
    EV_FLAG1    = 0x2000,

    /* returned values */
    EV_EOF      = 0x8000,
    EV_ERROR    = 0x4000
}

enum
{
    /*
     * data/hint flags for EVFILT_{READ|WRITE}, shared with userspace
     */
    NOTE_LOWAT      = 0x0001,

    /*
     * data/hint flags for EVFILT_VNODE, shared with userspace
     */
    NOTE_DELETE     = 0x0001,
    NOTE_WRITE      = 0x0002,
    NOTE_EXTEND     = 0x0004,
    NOTE_ATTRIB     = 0x0008,
    NOTE_LINK       = 0x0010,
    NOTE_RENAME     = 0x0020,
    NOTE_REVOKE     = 0x0040,

    /*
     * data/hint flags for EVFILT_PROC, shared with userspace
     */
    NOTE_EXIT       = 0x80000000,
    NOTE_FORK       = 0x40000000,
    NOTE_EXEC       = 0x20000000,
    NOTE_PCTRLMASK  = 0xf0000000,
    NOTE_PDATAMASK  = 0x000fffff,

    /* additional flags for EVFILT_PROC */
    NOTE_TRACK      = 0x00000001,
    NOTE_TRACKERR   = 0x00000002,
    NOTE_CHILD      = 0x00000004

}

int kqueue();
int __kevent50(int kq, const kevent_t *changelist, int nchanges,
           kevent_t *eventlist, int nevents,
           const timespec *timeout);
alias kevent = __kevent50;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /**
 * D header file for NetBSD.
 *
 * http://cvsweb.netbsd.org/bsdweb.cgi/~checkout~/src/include/link_elf.h
 */
module core.sys.netbsd.sys.link_elf;

version (NetBSD):
extern (C):
nothrow:

import core.stdc.stdint : uint64_t;
import core.sys.netbsd.sys.elf;

version (D_LP64)
    enum __ELF_NATIVE_CLASS = 64;
else
    enum __ELF_NATIVE_CLASS = 32;

template ElfW(string type)
{
    mixin("alias Elf"~__ELF_NATIVE_CLASS.stringof~"_"~type~" ElfW;");
}

struct link_map
{
    char*           l_addr;

    version (MIPS32)
        char*       l_offs;
    version (MIPS64)
        char*       l_offs;

    char*           l_name;
    void*           l_ld;
    link_map*       l_next;
    link_map*       l_prev;
}
alias link_map Link_map;

enum
{
    RT_CONSISTENT,
    RT_ADD,
    RT_DELETE,
}

struct r_debug
{
    int             r_version;
    link_map*       r_map;
    void function(r_debug*, link_map*) r_brk;
};

struct dl_phdr_info
{
    ElfW!"Addr"     dlpi_addr;
    char*           dlpi_name;
    ElfW!"Phdr"*    dlpi_phdr;
    ElfW!"Half"     dlpi_phnum;
    uint64_t        dlpi_adds;
    uint64_t        dlpi_subs;
    size_t          dlpi_tls_modid;
    void*           dlpi_tls_data;
};


private alias extern(C) int function(dl_phdr_info*, size_t, void *) dl_iterate_phdr_cb;
private alias extern(C) int function(dl_phdr_info*, size_t, void *) @nogc dl_iterate_phdr_cb_ngc;
extern int dl_iterate_phdr(dl_iterate_phdr_cb __callback, void*__data);
extern int dl_iterate_phdr(dl_iterate_phdr_cb_ngc __callback, void*__data) @nogc;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /**
 * D header file for NetBSD
 *
 * Authors: Martin Nowak
 *
 * http://cvsweb.netbsd.org/bsdweb.cgi/~checkout~/src/sys/sys/mman.h
 */
module core.sys.netbsd.sys.mman;

version (NetBSD):
extern (C):
nothrow:

public import core.sys.posix.sys.mman;
import core.sys.posix.sys.types;

enum __BSD_VISIBLE = true;

static if (__BSD_VISIBLE)
{
    enum INHERIT_SHARE = 0;
    enum INHERIT_COPY = 1;
    enum INHERIT_NONE = 2;
    enum INHERIT_DONATE_COPY = 3;
    enum INHERIT_ZERO = 4;
}

// already in core.sys.posix.sys.mman
// enum PROT_NONE = 0x00;
// enum PROT_READ = 0x01;
// enum PROT_WRITE = 0x02;
// enum PROT_EXEC = 0x04;
// enum MAP_SHARED = 0x0001;
// enum MAP_PRIVATE = 0x0002;
static if (__BSD_VISIBLE)
    enum MAP_COPY = 0x0002;
// enum MAP_FIXED = 0x0010;

static if (__BSD_VISIBLE)
{
    enum MAP_RENAME = 0x0020;
    enum MAP_NORESERVE = 0x0040;
    enum MAP_HASSEMAPHORE = 0x0200;
    enum MAP_STACK = 0x2000;
    enum MAP_WIRED = 0x0800;

    enum MAP_FILE = 0x0000;

    // already in core.sys.posix.sys.mman
    // enum MAP_ANON = 0x1000;
    //#ifndef _KERNEL
    alias MAP_ANONYMOUS = MAP_ANON;
    //#endif /* !_KERNEL */


    extern(D) int MAP_ALIGNED(int n) { return n << MAP_ALIGNMENT_SHIFT; }
    enum MAP_ALIGNMENT_SHIFT = 24;
    enum MAP_ALIGNMENT_MASK = MAP_ALIGNED(0xff);
}

//static if (__POSIX_VISIBLE >= 199309)
//{
    // already in core.sys.posix.sys.mman
    // enum MCL_CURRENT = 0x0001;
    // enum MCL_FUTURE = 0x0002;
//}

// already in core.sys.posix.sys.mman
enum MAP_FAILED = cast(void*)-1;

// already in core.sys.posix.sys.mman
// enum MS_SYNC = 0x0000;
// enum MS_ASYNC = 0x0001;
// enum MS_INVALIDATE = 0x0002;

enum _MADV_NORMAL = 0;
enum _MADV_RANDOM = 1;
enum _MADV_SEQUENTIAL = 2;
enum _MADV_WILLNEED = 3;
enum _MADV_DONTNEED = 4;

static if (__BSD_VISIBLE)
{
    alias MADV_NORMAL = _MADV_NORMAL;
    alias MADV_RANDOM = _MADV_RANDOM;
    alias MADV_SEQUENTIAL = _MADV_SEQUENTIAL;
    alias MADV_WILLNEED = _MADV_WILLNEED;
    alias MADV_DONTNEED = _MADV_DONTNEED;
    enum MADV_SPACEAVAIL = 5;
    enum MADV_FREE = 6;
}

//static if (__POSIX_VISIBLE >= 200112)
//{
    // already in core.sys.posix.sys.mman
    // alias POSIX_MADV_NORMAL = _MADV_NORMAL;
    // alias POSIX_MADV_RANDOM = _MADV_RANDOM;
    // alias POSIX_MADV_SEQUENTIAL = _MADV_SEQUENTIAL;
    // alias POSIX_MADV_WILLNEED = _MADV_WILLNEED;
    // alias POSIX_MADV_DONTNEED = _MADV_DONTNEED;
//}

static if (__BSD_VISIBLE)
{
    //int getpagesizes(size_t *, int);
    int madvise(void *, size_t, int);
    int mincore(const(void) *, size_t, char *);
    int minherit(void *, size_t, int);
}
// already in core.sys.posix.sys.mman
// int mlock(const void *, size_t);
// void *  mmap(void *, size_t, int, int, int, off_t);
// int mprotect(const void *, size_t, int);
// int msync(void *, size_t, int);
// int munlock(const void *, size_t);
// int munmap(void *, size_t);
//static if (__POSIX_VISIBLE >= 200112)
    // int posix_madvise(void *, size_t, int);
//static if (__POSIX_VISIBLE >= 199309)
//{
    // int mlockall(int);
    // int munlockall();
    // int shm_open(const(char) *, int, mode_t);
    // int shm_unlink(const(char) *);
//}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //Written in the D programming language

/++
    D header file for NetBSD's extensions to POSIX's time.h.

    Copyright: Copyright 2014
    License:   $(HTTP www.boost.org/LICENSE_1_0.txt, Boost License 1.0).
    Authors:   $(HTTP jmdavisprog.com, Jonathan M Davis)

    http://cvsweb.netbsd.org/bsdweb.cgi/~checkout~/src/sys/sys/time.h
 +/
module core.sys.netbsd.time;

public import core.sys.posix.time;

version (NetBSD):

enum CLOCK_REALTIME          = 0;
enum CLOCK_VIRTUAL           = 1;
enum CLOCK_PROF              = 2;
enum CLOCK_MONOTONIC         = 3;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             2   .   Ç   ..  3  èdlfcn.d                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         